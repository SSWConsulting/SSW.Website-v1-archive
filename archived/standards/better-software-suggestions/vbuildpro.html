<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head id="ctl00_Head1">
<script>
   (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NXDBVV');
  </script>
<title>
   SSW Visual Build PRO Suggestions
  </title>
<meta content="en-au" http-equiv="Content-Language"/>
<meta content="IE=Edge" http-equiv="X-UA-Compatible"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="SSW, Consultants for software, database and website development, Software development, website development, web development, development, Access, SQL Server, ASP, .net, DotNet, Dot net, ASP.NET, VB.NET, C#, visual basic, database, website, web site, consultants, application, shopping cart, Internet, web, exchange server, sharepoint portal server, sharepoint team services,Database Design Australia, .Net development, sydney Australia, Web Design Australia, website design, web design, IT Services Australia, developers, Database Architect, Software architect, Software solution, Custom database solutions,Custom software solutions, downloads, Website design Australia, Online Database Australia, e-business, web development sydney, website development sydney, CRM, CRM Solution, SharePoint solution, MOSS solution, ebusiness, Sydney, Australia, Sydney Australia, Beijing China, Penang Malaysia, Sao Paulo Brazil" id="ctl00_keywords" name="keywords"/>
<meta content="Angular, React, Vue, Azure, Azure DevOps (was TFS), SharePoint, Office 365, Blazor, .NET, WebAPI, Dynamics 365, and SQL Server. We have software consultants located in Sydney, Brisbane, Melbourne, Newcastle, and China." name="description"/>
<meta content="SSW" name="author"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="/archived/css/Content.css" id="ctl00_Link1" media="screen" rel="stylesheet" type="text/css"/>
<link href="/archived/css/Screen.css" id="ctl00_screenCSS" media="screen" rel="stylesheet" type="text/css"/>
<link href="/archived/Images/icoSSW_2014.ico" rel="shortcut icon"/>
<link href="/archived/include/googleSyntax/shCore.css" rel="stylesheet" type="text/css"/>
<link href="/archived/include/googleSyntax/shThemeDefault.css" rel="stylesheet" type="text/css"/>
<link href="/archived/css/Print.css" id="ctl00_printCSS" media="print" rel="stylesheet" type="text/css"/>
<!-- Start of pdi-ssw Zendesk Widget script -->
<!-- End of pdi-ssw Zendesk Widget script -->
<link href="https://a.omappapi.com/app/js/api.min.css" id="omapi-css" media="all" rel="stylesheet"/>
</head>
<body id="ctl00_MasterBody" style="opacity: 1 !important;">
<div style="
        line-height: 1.5;
        text-align: center; 
        font-size: 1.125rem; 
        color: #999;
        background-color: #333333;
        padding-top: 1.25rem;
        padding-bottom: 1.25rem;
        padding-right: 0.75rem;
        padding-left: 0.75rem;
    ">
<div style="color: white; font-size: 2rem !important; font-weight: 600;">
    ⚠️ This page has been archived
   </div>
<div style="color: white; font-size: 1.125rem !important; font-weight: 600;">
<p style="color:white;">
     ✅ New page with updated info:
     <a href="https://www.ssw.com.au" style="color: white">
      ssw.com.au
     </a>
</p>
</div>
</div>
<noscript>
<iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-NXDBVV" style="display:none;visibility:hidden" width="0">
</iframe>
</noscript>
<form action="./vbuildpro.aspx" id="aspnetForm" method="post" name="aspnetForm">
<div>
<input id="__VIEWSTATE" name="__VIEWSTATE" type="hidden" value="/wEPDwUJODQyOTM2NjUyD2QWAmYPZBYCAgMPZBYCAgEPZBYGAgMPPCsABQEADxYCHgdWaXNpYmxlaGRkAgUPPCsABQEADxYCHwBoZGQCBw88KwAFAQAPFgIfAGhkZGSkQvt+HVahELgHC8pafZCahT/RDjiIPWrd46NJH4rIYw=="/>
</div>
<div>
<input id="__VIEWSTATEGENERATOR" name="__VIEWSTATEGENERATOR" type="hidden" value="8E7BC0CA"/>
</div>
<div id="mainContainer">
<div>
</div>
<p>
<span id="ctl00_mainContentPlaceHolder_SiteMapPath1">
<a href="#ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink">
</a>
<span>
<a href="/history" title="Home">
        Home
       </a>
</span>
<span>
       &gt;
      </span>
<span>
<a href="/history/standards" title="SSW Standards">
        SSW Standards
       </a>
</span>
<span>
       &gt;
      </span>
<span>
<a href="/history/standards/better-software-suggestions" title="Better Software Suggestions">
        Better Software Suggestions
       </a>
</span>
<span>
       &gt;
      </span>
<span>
       SSW Visual Build PRO Suggestions
      </span>
<a id="ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink">
</a>
</span>
</p>
<span id="ctl00_mainContentPlaceHolder_lblWelcome">
</span>
<p>
</p>
<table align="right" cellpadding="2" cellspacing="2" class="clsSSWTableOfContents" style="{width:100%;}" summary="Index">
<tbody>
<tr>
<td>
        1.
        <a href="#IncludeExclude">
         Include and Exclude Mask Consistency
        </a>
<br/>
        2.
        <strike>
<a href="#Rename">
          Rename Files or Folders
         </a>
</strike>
<span style="font-weight: bold; color: red">
         * Fixed by Kinook in Visual Build Pro 6.0 *
        </span>
<br/>
        3.
        <a href="#CheckOut">
         Is any File Checked Out?
        </a>
<br/>
        4.
        <strike>
<a href="#LoseFocus">
          Losing focus when text is selected in a text area
         </a>
</strike>
<span style="font-weight: bold; color: red">
         * Fixed by Kinook in Visual Build Pro 6.0 *
        </span>
<br/>
</td>
</tr>
</tbody>
</table>
<ol>
<li>
<h2>
<a name="IncludeExclude">
</a>
       Include and Exclude Mask Consistency
      </h2>
</li>
<p>
</p>
<p>
      Visual Build PRO provides two columns in certain steps, namely the step that is used for copying or moving files or folders 
		as shown in Figure 1 below:
     </p>
<p>
<img alt="Visual Build PRO" border="0" height="422" src="/history/standards/better-software-suggestions/images/vbuild-pro1.jpg" width="520"/>
<br/>
<b>
       Figure 1: The "Copy" step properties showing include and exclude 
		text areas that should be available in the "Source Safe" step properties.
      </b>
</p>
<p>
      This option proves to be very useful and can be a very important option 
		when wanting to use Source Safe to either Get latest or Check out 
		specific files or folders.
     </p>
<p>
      However Visual Build Pro does not provide the option to exclude certain 
		masked out files or folders for the step that provides access to Source 
		Safe as shown in Figure 2.
     </p>
<p>
<img alt="Visual Build PRO" border="0" height="422" src="/history/standards/better-software-suggestions/images/vbuild-pro1a.jpg" width="520"/>
<br/>
<b>
       Figure 2: The "SourceSafe" step properties which only provides a text 
		area to include items. There is no option to exclude particular files.
      </b>
</p>
<p>
      Users may want to keep certain files on their local drive that have been modified. This 
		may include the actual Visual Build Script itself.
     </p>
<p>
      If the user modifies the build process while having Visual Build open, then restarts the build 
		which could include a step to get the latest folder in source safe 
		which may include that build script itself, it may prove to be inconvenient. 
		If 
		the user believes that the Visual Build script instance that is currently 
		opened seems to be saved, this may or may not be the one stored in the local drive after 
		the get latest step.
     </p>
<p>
       
     </p>
<p>
</p>
<p>
</p>
<li>
<h2>
<strike>
<a name="Rename">
</a>
        Rename Files or Folders
       </strike>
       -
       <span style="font-weight: bold; color: red">
        * Fixed by Kinook in Visual Build Pro 6.0 *
       </span>
</h2>
<p>
       When dealing with files and folders, the "Copy" step seems the most 
		likely to have what they need. Although it provides the options to copy, 
		move, delete or replace text within files, it does not provide an option 
		for renaming files themselves.
      </p>
<p>
<img alt="Visual Build PRO" border="0" height="422" src="/history/standards/better-software-suggestions/images/vbuild-pro2a.jpg" width="520"/>
<br/>
<b>
        Figure 1: The "Copy" step without the option to rename files.
       </b>
</p>
<p>
       Developers would find a renaming option very useful. As they build a 
		setup file from a solution they want released, previous version numbers 
		will continually mount up in the public folder used for release setup 
		files. A clean up process should be made to rename any previous setup 
		versions as we do in SSW, and "zz" them to push them down to the bottom of 
		the file list.
      </p>
<p>
       Developers using Visual Build PRO think renaming is not supported so they would have to create 
		an extra step using a script to access the folder and rename it with the 
		"Scripting.FileSystemObject" COM.
       <br/>
<br/>
       When you create this step it will allow you to clean up any previous file 
		moves that you have made from the build script.
      </p>
<p>
       With the script created to provide a "clean up" of your files, the 
		following code snippet found in Figure 2 proved to be useful.
      </p>
<pre><br/>Set FileManagment = CreateObject ("Scripting.FileSystemObject")<br/>Set TheFolder = FileManagment.GetFolder("%BeeFolder%")
<br/>Set FileList = TheFolder.Files
<br/><br/>For Each File in FileList 
<br/><br/>          fileStart = instr(ThisFile, ".msi") - 1
<br/>     fileNoExt = mid(ThisFile, 1, fileStart)
<br/>     File.Name = Replace( File.Name, fileNoExt , "zz"&amp;File.Name&amp;"(zzed_by_VBP).msi")
<br/><br/>Next</pre>
<p>
<b>
        Figure 2: Rename all the files appending zz at the front, and (zzed_by_VBP).msi 
		to the back.
       </b>
</p>
<p>
        
      </p>
</li>
<li>
<h2>
<a name="CheckOut">
</a>
       Is any File Checked Out?
      </h2>
</li>
<p>
      Although Visual Build PRO provides the user with the option to skip over local 
		writable files as shown in Figure 1, the VSS command-line tool doesn't 
		distinguish between checked out and non-checked out writeable files.
     </p>
<p>
<img alt="Visual Build PRO" border="0" height="422" src="/history/standards/better-software-suggestions/images/vbuild-pro3.jpg" width="520"/>
<br/>
<b>
       Figure 1: Source Safe properties can skip files that have the "Read-Only" property unchecked, 
		however that does not necessarily mean they are checked-out.
      </b>
</p>
<p>
      To distinguish between files that are checked out or not can be 
				a very useful option as users can accidentally run the Visual 
				Build script while having the first step as a "Get Latest" and 
				end up overwriting all the files that they have forgotten to 
				checked-in, and hense overwrite all that they have done.
     </p>
<p>
      The temporary solution was to create a script that would access the 
		"SourceSafe" COM object and check the status of the file itself.
     </p>
<p>
      The IsCheckedOut() method returns 0 for a file that is not checked 
		out, 1 for a file that is checked out by a user, and 2 for a file that 
		is checked out by the current user.
     </p>
<pre><br/>const isFolder = 0
<br/>const isFile = 1

<br/>dim VSS_FolderName
<br/>VSS_FolderName = "$/%VSSPath%/"

<br/>Set VSS = CreateObject("SourceSafe")
<br/>VSS.open "%VSS%"

<br/>CheckTheFolder VSS.VSSItem (VSS_FolderName)

<br/>Sub CheckTheFolder(objVSSFolder)

<br/>For Each VSSObj In objVSSFolder.Items(False)
<br/><br/>        If ype = isFile Then				
              If VSSObj.IsCheckedOut = 2 Then
<br/>                   Project.Stop	
<br/>              End if
<br/><br/>        Else
<br/>              VSS_FolderName = VSS_FolderName &amp; VSSObj.Name &amp; "/"
<br/>              set objVSS_SubFolder = VSS.VSSItem (VSS_FolderName)
<br/><br/>              CheckTheFolder(objVSS_SubFolder)
<br/><br/>              VSS_FolderName = Replace(VSS_FolderName, VSSObj.Name&amp;"/" ,"")			
<br/>        End if
<br/><br/>Next

<br/>End Sub</pre>
<p>
<b>
       Figure 1: Check recursively for files that have been 
		checked-out-by-me.
       <br/>
        
      </b>
</p>
<p>
       
     </p>
<li>
<h2>
<strike>
<a name="LoseFocus">
</a>
        Losing focus when text is selected in a text area
       </strike>
       -
       <span style="font-weight: bold; color: red">
        * Fixed by Kinook in Visual Build Pro 6.0 *
       </span>
</h2>
</li>
<p>
      1. When you open a dialog box (double click a step in the build) 
		then highlight a section of text i.e. as shown in Figure 1: 
     </p>
<p class="MsoNormal">
       
     </p>
<p class="MsoNormal">
<img alt="Visual Build PRO" border="0" height="355" src="/history/standards/better-software-suggestions/images/vbp-beforefocus.png" width="513"/>
<br/>
<b>
       Figure 1: A highlighted section of text in the text area BEFORE losing 
	focus of the Visual Build Application
      </b>
<br/>
<br/>
       
     </p>
<p class="MsoNormal">
      2. Then you lose focus of the Visual Build Program and 
	return to it the text dissapeard as is shown in Figure 2a and 2b:
     </p>
<p class="MsoNormal">
<img alt="Visual Build PRO" border="0" height="356" src="/history/standards/better-software-suggestions/images/vbp-afterfocus.png" width="516"/>
<br/>
<b>
       Figure 2a: Code has disappeared after returning focus to the Visual Build 
	Application
      </b>
</p>
<p class="MsoNormal" style="margin-left:72.0pt">
       
     </p>
<p class="MsoNormal">
<img alt="Visual Build PRO" border="0" height="354" src="/history/standards/better-software-suggestions/images/vbp-clickfocus.png" width="516"/>
<br/>
<b>
       Figure 2b: SOME Code has re-appeared after clicking in the text area.
      </b>
</p>
<p>
<br/>
<br/>
       
     </p>
<li>
<h2>
       Acknowledgements
      </h2>
<p>
       Adam Cogan,
			Adel Helal
      </p>
</li>
</ol>
<br/>
</div>
<div id="footer">
<p class="callnow">
     Call Now
     <a href="tel:+61299533000">
      +61 2 9953 3000
     </a>
</p>
<span class="copyright">
     © Copyright SSW 1990-2024. All Rights Reserved.
    </span>
<ul>
<li class="first">
<a class="email" href="javascript:sendEmail('696E666F407373772E636F6D2E61753F7375626A6563743D466565646261636B20746F2053535726626F64793D687474703A2F2F7373772E636F6D2E61752F7373772F5374616E64617264732F426574746572536F66747761726553756767657374696F6E732F766275696C6470726F2E61737078')" id="ctl00_fC_feedbackHyperLink" tabindex="100">
       Feedback to SSW
      </a>
</li>
<li>
<a href="/ssw/Company/AboutUs.aspx">
       About SSW
      </a>
</li>
<li>
<a href="/ssw/Advertising/Default.aspx">
       Advertising
      </a>
</li>
<li class="last">
<a href="/ssw/MenuMap.aspx">
       Sitemap
      </a>
</li>
</ul>
<span class="proudly">
<a href="http://www.ssw.com.au">
      Proudly developed by SSW Sydney Web Design
     </a>
</span>
<!-- span class="proudlyAjax"><a href="/ssw/Standards/Rules/RulesToBetterWebsitesAdministration.aspx#AJAX">Powered by MS AJAX</a></span -->
<p class="serverName">
     Our website is under constant continuous deployment. Last deployment to AZIIS2022P03. Unable to retrieve changeset details.
    </p>
</div>
</form>
<!--Here's the Google Tracking Code, only available on external servers because we only need to track for external.-->
<!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com -->
<!-- / OptinMonster -->
<div style="visibility: visible;">
<div>
</div>
<div>
</div>
</div>
</body>
</html>
