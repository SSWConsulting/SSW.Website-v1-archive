<html xmlns="http://www.w3.org/1999/xhtml"><head id="ctl00_Head1"><title>
	SSW Rules for Regular Expressions
</title><meta content="en-au" http-equiv="Content-Language"/><meta content="IE=Edge" http-equiv="X-UA-Compatible"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="SSW, Consultants for software, database and website development, Software development, website development, web development, development, Access, SQL Server, ASP, .net, DotNet, Dot net, ASP.NET, VB.NET, C#, visual basic, database, website, web site, consultants, application, shopping cart, Internet, web, exchange server, sharepoint portal server, sharepoint team services,Database Design Australia, .Net development, sydney Australia, Web Design Australia, website design, web design, IT Services Australia, developers, Database Architect, Software architect, Software solution, Custom database solutions,Custom software solutions, downloads, Website design Australia, Online Database Australia, e-business, web development sydney, website development sydney, CRM, CRM Solution, SharePoint solution, MOSS solution, ebusiness, Sydney, Australia, Sydney Australia, Beijing China, Penang Malaysia, Sao Paulo Brazil" id="ctl00_keywords" name="keywords"/><meta content="Angular, React, Vue, Azure, Azure DevOps (was TFS), SharePoint, Office 365, Blazor, .NET, WebAPI, Dynamics 365, and SQL Server. We have software consultants located in Sydney, Brisbane, Melbourne, Newcastle, and China." name="description"/><meta content="SSW" name="author"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><link href="/history/css/Content.css" id="ctl00_Link1" media="screen" rel="stylesheet" type="text/css"/><link href="../../include/Adapters/CSS/Import.css" id="ctl00_AdaptersInvariantImportCSS" rel="stylesheet" type="text/css"/><link href="/history/css/Screen.css" id="ctl00_screenCSS" media="screen" rel="stylesheet" type="text/css"/><link href="/ssw/Images/icoSSW_2014.ico" rel="shortcut icon"/>














<link href="/ssw/include/googleSyntax/shCore.css" rel="stylesheet" type="text/css"/><link href="/ssw/include/googleSyntax/shThemeDefault.css" rel="stylesheet" type="text/css"/>

<link href="/history/css/Print.css" id="ctl00_printCSS" media="print" rel="stylesheet" type="text/css"/>
<!-- Start of pdi-ssw Zendesk Widget script -->

<!-- End of pdi-ssw Zendesk Widget script -->
<link href="https://a.omappapi.com/app/js/api.min.css" id="omapi-css" media="all" rel="stylesheet"/></head>
<body id="ctl00_MasterBody">
<form action="./RulesToBetterRegularExpressions.aspx" id="aspnetForm" method="post" name="aspnetForm">
<div>
<input id="__VIEWSTATE" name="__VIEWSTATE" type="hidden" value="/wEPDwUKMTIzNTc4MzQxMQ9kFgJmD2QWAgIDD2QWAgIBD2QWBgIDDzwrAAUBAA8WAh4HVmlzaWJsZWhkZAIFDzwrAAUBAA8WAh8AaGRkAgcPPCsABQEADxYCHwBoZGRkB0YJR1deqhk6boUbKILTqkpMlCy/UayR+V63rQdxWrQ="/>
</div>
<div>
<input id="__VIEWSTATEGENERATOR" name="__VIEWSTATEGENERATOR" type="hidden" value="67D675E9"/>
</div>
<div id="header" title="SSW Rules for Regular Expressions">
<a href="/ssw/">
<img alt="SSW Logo" height="100" id="sswlogo" src="/history/images/SSWLogo.png" width="130"/></a>
<a href="/ssw/Company/AboutUs.aspx">
<img alt="Microsoft Gold Partner Logo" height="41" id="msgoldpartner" src="/history/company/images/small_partnerlogo.png" width="110"/></a>
<h1>
        SSW Rules for Regular Expressions</h1>
</div>
<div id="mainContainer">
<div>
</div>
<p>
<span id="ctl00_mainContentPlaceHolder_SiteMapPath1"><a href="#ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"><img alt="Skip Navigation Links" height="0" src="/history/WebResource.axd" style="border-width:0px;" width="0"/></a><span><a href="/ssw/Default.aspx" title="Home">Home</a></span><span> &gt; </span><span><a href="/ssw/Standards/Default.aspx" title="SSW Standards">SSW Standards</a></span><span> &gt; </span><span><a href="/ssw/Standards/Rules/Default.aspx" title="Rules">Rules</a></span><span> &gt; </span><span>SSW Rules for Regular Expressions</span><a id="ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"></a></span>
</p>
<br/>
<div class="TableOfContents">
<ol>
<li><a href="#regex">Do you format and comment your regular expressions?</a></li>
<li><a href="#testregex">Do you test your regular expression?</a></li>
<li><a href="#ResourceRegex">Do you use resource file to store your regular expressions?</a></li>
</ol>
</div> <p>Do you agree with them all? Are we missing some?  <a href="javascript:sendEmail('696e666f407373772e636f6d2e61753f5375626a6563743d52756c6573253230746f253230426574746572253230536f75726365253230436f6e74726f6c')" onmouseout="javascript:clearStatus(); return true;" onmouseover="javascript:displayStatus('696e666f407373772e636f6d2e61753f5375626a6563743d52756c6573253230746f253230426574746572253230536f75726365253230436f6e74726f6c');return true;">     Let us know </a> what you think.</p>
<ol>
<li>
<h2>
<a name="regex"></a>Do you format and comment your regular expressions?</h2>
<p>
                Regular expressions are a very powerful tool for pattern matching, but a 
                complicated regex can be very difficult for a human to read and to comprehend. 
                That is why, like any good code, a good regular expression must be well formatted 
                and documented.</p>
<p>
                Here are some guidelines when formatting and documenting your regex:</p>
<ol>
<li>Keep each line under 80 characters, horizontal scrolling reduces readability.</li>
<li>Break long patterns into multiple lines, usually after a space or a line break.</li>
<li>Indent bracers to help think in the right scope.</li>
<li>Format complicated OR patterns into multiple blocks like a case statement.</li>
<li>Comment your regex on what it does, don't just translate it into English.</li>
</ol>
<dl class="badCode">
<dt># Match &lt;BODY<br/>&lt;BODY<br/># Match any non &gt; char for zero to infinite number 
                    of times<br/>[^&gt;]*<br/># MATCH &gt;<br/>&gt;
                            </dt>
<dd>
                    Bad example: Comment that translates the regex into English.</dd>
</dl>
<dl class="goodCode">
<dt># Match the BODY tag<br/>&lt;BODY<br/># Match any character in the body tag<br/>
                    [^&gt;]*<br/># Match the end BODY tag<br/>&gt;
                            </dt>
<dd>
                    Good example: Comment that explains the purpose of the pattern.</dd>
</dl>
<dl class="badCode">
<dt>(?six-mn:(Label|TextBox)\s+(?&lt;Name&gt;\w+).*(?&lt;Result&gt;\k&lt;Name&gt;\.TextAlign\s*=\s* 
                    ((System\.)?Drawing\.)?ContentAlignment\.(?! 
                    TopLeft|MiddleLeft|TopCenter|MiddleCenter)\w*)(?!(?&lt;=\k&lt;Name&gt;\.Image.*)|(?
                                <br/>=.*\k&lt;Name&gt;\.Image)))
                </dt>
<dd>
                    Bad Example: Pray you never have to modify this regex.</dd>
</dl>
<dl class="goodCode">
<dt>(?six-mn:<br/>    # Match for Label or TextBox control<br/>    # Store name 
                    into &lt;name&gt; group<br/>    (Label|TextBox)\s+(?&lt;Name&gt;\w+).*<br/>
<br/>    # Match any non-standard TextAlign<br/>    # Store any match in 
                    Result group for error reporting in CA<br/>    (?&lt;Result&gt;<br/>        # Match 
                    for control's TextAlign Property<br/>        \k&lt;Name&gt;\.TextAlign\s*=\s*<br/>
<br/>        # Match for possible namespace<br/>        
                    ((System\.)?Drawing\.)?ContentAlignment\.<br/>
<br/>        # Match any ContentAlignment that is not in the group<br/>        
                    (?!TopLeft|MiddleLeft|TopCenter|MiddleCenter)\w*<br/>    )<br/>
<br/>    # Skip any Control that has image on it<br/>    (?!<br/>        (?&lt;=<br/>
                                \k&lt;Name&gt;\.Image<br/>            .*<br/>        )<br/>    |<br/>
                            (?=<br/>            .*<br/>            \k&lt;Name&gt;\.Image<br/>        )<br/>
                        )<br/>)
                            </dt>
<dd>
                    Good Example: Now it make sense!</dd>
</dl>
</li>
<li>
<h2>
<a name="testregex"></a>Do you test your regular expressions?</h2>
<p>
                Everyone writes unit tests for their code, because it helps developer to make 
                changes in future without breaking existing functionalities. The same goes for 
                regular expressions.  A good regular expression will have a set of test cases to 
                make sure any future changes does not invalidate existing requirements.
            </p>
<p>
                At SSW, we do not fix a regular expression until we have added a good and a bad 
                test case.</p>
<p>
                If your application is driven by regular expressions, you need a good test 
                harness. Here is an example of a test harness we use in Code Auditor.
            </p>
<img alt="Test Harness for regular expressions in Code Auditor." height="462" src="/history/Images/CodeAuditorRegexTester.gif" title="Test Harness for regular expressions in Code Auditor." width="527"/>
<br/><b>Figure: Test Harness for regular expressions in Code Auditor.</b>
</li>
<li>
<h2>
<a name="ResourceRegex"></a>Do you use resource file to store your regular 
                expressions?</h2>
<p>
</p><dl class="badCode">
<dt>
<pre>public static Queue getFilesInProject(string projectFile)
{
	Queue tempQueue = new Queue();

	TextReader tr = File.OpenText(projectFile);

	// RT (10/10/2005): New regex to support VS 2005 project files (.csproj &amp; .vbproj)
	//(?ixm-sn:
	//# VS 2003
	//(?:RelPath\s=\s\"(?&lt;filename&gt;.*?)\")
	//|
	//# VS 2005
	//(?:(?&lt;=Compile|EmbeddedResource|Content|None)\sInclude=\"(?&lt;FileName&gt;.*?)\")
	//)
	Regex regex = new Regex
	    (<span style="background-color: #FF0000">@"(?ixm-sn:(?:RelPath\s=\s\""(?&lt;FileName&gt;.*?)\"")|(?:(?&lt;=Compile|EmbeddedResource|Content|None)\sInclude=\""(?&lt;FileName&gt;.*?)\""))"</span>);
	MatchCollection matches = regex.Matches(tr.ReadToEnd());

}</pre>
</dt>
<dd>
                        Figure: Regular expression is embedded in code (Bad)</dd>
</dl>
<p></p>
<p>
                The problem with this code is that the regular expression is embedded within the 
                method and not easily testable without creating mock files on-the-fly, etc. 
                Another issue with embedding regular expressions in-code is escaping issues - 
                often people will forget to escape the special characters or escape them 
                incorrectly and thus cause the regular expression to behave differently between 
                the design and execution environments.
                <br/>
<br/>The way we deal with this is to put the regular expression in a resource 
                file. Using a resource file, it solves the aforementioned issues, and it also 
                allows us to leave a comment for the regular expression.
            </p>
<p>
</p><dl class="goodImage">
<dt>
<img src="/history/Images/ResourceRegularExpression.gif"/></dt>
<dd>
                        Figure: The regular expression (with comment) is stored in a resource file 
                        (Good)</dd>
</dl>
<p></p>
<p>
</p><dl class="goodCode">
<dt>
<pre>public static Queue getFilesInProject(string projectFile)
{
	Queue tempQueue = new Queue();

	TextReader tr = File.OpenText(projectFile);

	Regex regex = new Regex(<span style="background-color: #00FF00">RegularExpression.GetFilesInProject</span>);
	MatchCollection matches = regex.Matches(tr.ReadToEnd());

}</pre>
</dt>
<dd>
                        Figure: We can easily get the regular expression from resource file (Good)</dd>
</dl>
<p></p>
</li>
</ol>
<h2>
        Acknowledgements</h2>
<p>
<a href="/ssw/Employees/EmployeesProfile.aspx?EmpID=AC">Adam Cogann</a>
<br/>
<a href="/ssw/Employees/EmployeesProfile.aspx?EmpID=CS">Cameron Shaw</a><br/>
<a href="/ssw/Employees/EmployeesProfile.aspx?EmpID=TF">Tim Fletcher</a><br/>
        Edward Forgacs</p>
<br/>
</div>

<div id="footer">
<p class="callnow">Call Now +61 2 9953 3000</p>
<span class="copyright">© Copyright SSW 1990-2023. All Rights Reserved.</span>
<ul>
<li class="first"><a class="email" href="javascript:sendEmail('696E666F407373772E636F6D2E61753F7375626A6563743D466565646261636B20746F2053535726626F64793D687474703A2F2F7373772E636F6D2E61752F7373772F5374616E64617264732F52756C65732F52756C6573546F426574746572526567756C617245787072657373696F6E732E61737078')" id="ctl00_fC_feedbackHyperLink" tabindex="100">Feedback to SSW</a></li>
<li><a href="/ssw/Company/AboutUs.aspx">About SSW</a></li>
<li><a href="/ssw/Advertising/Default.aspx">Advertising</a></li>
<li class="last"><a href="/ssw/MenuMap.aspx">Sitemap</a></li>
</ul>
<span class="proudly"><a href="http://www.ssw.com.au">Proudly developed by SSW Sydney Web Design</a></span>
<!-- span class="proudlyAjax"><a href="/ssw/Standards/Rules/RulesToBetterWebsitesAdministration.aspx#AJAX">Powered by MS AJAX</a></span -->
<p class="serverName">Our website is under constant continuous deployment. Last deployment to AZIIS2022P03. Unable to retrieve changeset details.</p>
</div>
</form>
<!--Here's the Google Tracking Code, only available on external servers because we only need to track for external.-->



<!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com --><!-- / OptinMonster -->
<div style="visibility: visible;"><div></div><div><style>
        @-webkit-keyframes ww-832f303f-f902-4cf1-afba-27e6f4da4226-launcherOnOpen {
          0% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }

          30% {
            -webkit-transform: translateY(-5px) rotate(2deg);
                    transform: translateY(-5px) rotate(2deg);
          }

          60% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }


          90% {
            -webkit-transform: translateY(-1px) rotate(0deg);
                    transform: translateY(-1px) rotate(0deg);

          }

          100% {
            -webkit-transform: translateY(-0px) rotate(0deg);
                    transform: translateY(-0px) rotate(0deg);
          }
        }
        @keyframes ww-832f303f-f902-4cf1-afba-27e6f4da4226-launcherOnOpen {
          0% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }

          30% {
            -webkit-transform: translateY(-5px) rotate(2deg);
                    transform: translateY(-5px) rotate(2deg);
          }

          60% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }


          90% {
            -webkit-transform: translateY(-1px) rotate(0deg);
                    transform: translateY(-1px) rotate(0deg);

          }

          100% {
            -webkit-transform: translateY(-0px) rotate(0deg);
                    transform: translateY(-0px) rotate(0deg);
          }
        }

        @keyframes ww-832f303f-f902-4cf1-afba-27e6f4da4226-widgetOnLoad {
          0% {
            opacity: 0;
          }
          100% {
            opacity: 1;
          }
        }

        @-webkit-keyframes ww-832f303f-f902-4cf1-afba-27e6f4da4226-widgetOnLoad {
          0% {
            opacity: 0;
          }
          100% {
            opacity: 1;
          }
        }
      </style></div></div></body></html>