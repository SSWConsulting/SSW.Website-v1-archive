<html xmlns="http://www.w3.org/1999/xhtml"><head id="ctl00_Head1"><title>
	SSW - Rules to Better Exchange Server
</title><meta content="en-au" http-equiv="Content-Language"/><meta content="IE=Edge" http-equiv="X-UA-Compatible"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="SSW, Consultants for software, database and website development, Software development, website development, web development, development, Access, SQL Server, ASP, .net, DotNet, Dot net, ASP.NET, VB.NET, C#, visual basic, database, website, web site, consultants, application, shopping cart, Internet, web, exchange server, sharepoint portal server, sharepoint team services,Database Design Australia, .Net development, sydney Australia, Web Design Australia, website design, web design, IT Services Australia, developers, Database Architect, Software architect, Software solution, Custom database solutions,Custom software solutions, downloads, Website design Australia, Online Database Australia, e-business, web development sydney, website development sydney, CRM, CRM Solution, SharePoint solution, MOSS solution, ebusiness, Sydney, Australia, Sydney Australia, Beijing China, Penang Malaysia, Sao Paulo Brazil" id="ctl00_keywords" name="keywords"/><meta content="Angular, React, Vue, Azure, Azure DevOps (was TFS), SharePoint, Office 365, Blazor, .NET, WebAPI, Dynamics 365, and SQL Server. We have software consultants located in Sydney, Brisbane, Melbourne, Newcastle, and China." name="description"/><meta content="SSW" name="author"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><link href="/history/css/Content.css" id="ctl00_Link1" media="screen" rel="stylesheet" type="text/css"/><link href="../../include/Adapters/CSS/Import.css" id="ctl00_AdaptersInvariantImportCSS" rel="stylesheet" type="text/css"/><link href="/history/css/Screen.css" id="ctl00_screenCSS" media="screen" rel="stylesheet" type="text/css"/><link href="/ssw/Images/icoSSW_2014.ico" rel="shortcut icon"/>














<link href="/ssw/include/googleSyntax/shCore.css" rel="stylesheet" type="text/css"/><link href="/ssw/include/googleSyntax/shThemeDefault.css" rel="stylesheet" type="text/css"/>

<link href="/history/css/Print.css" id="ctl00_printCSS" media="print" rel="stylesheet" type="text/css"/>
<!-- Start of pdi-ssw Zendesk Widget script -->

<!-- End of pdi-ssw Zendesk Widget script -->
<link href="https://a.omappapi.com/app/js/api.min.css" id="omapi-css" media="all" rel="stylesheet"/></head>
<body id="ctl00_MasterBody">
<form action="./RulesToBetterExchangeServer.aspx" id="aspnetForm" method="post" name="aspnetForm">
<div>
<input id="__VIEWSTATE" name="__VIEWSTATE" type="hidden" value="/wEPDwUKLTYyNDgzNjExNA9kFgJmD2QWAgIDD2QWAgIBD2QWCAIDDzwrAAUBAA8WAh4HVmlzaWJsZWhkZAIFDzwrAAUBAA8WAh8AaGRkAgcPPCsABQEADxYCHwBoZGQCCQ9kFgICAw9kFgICBg8PFgQeBFRleHQF+Qc8cCBzdHlsZT0iZm9udC1zaXplIDogMTFweDsgY29sb3IgOiAjYWFhIj5UaGVyZSB3YXMgYW4gZXJyb3IgZGlzcGxheWluZyB0aGUgdGVzdGltb25pYWxzLiBQbGVhc2UgPEEgSFJFRj0ibWFpbHRvOmluZm9Acyp3LmNvbS5hdT9TdWJqZWN0PUVycm9yIGRpc3BsYXlpbmcgVGVzdGltb25pYWxzJmJvZHk9IFVSTDogaHR0cHM6Ly9zc3cuY29tLmF1L3Nzdy9TdGFuZGFyZHMvUnVsZXMvUnVsZXNUb0JldHRlckV4Y2hhbmdlU2VydmVyLmFzcHgNCg0KJTBEIEVycm9yOiBBIG5ldHdvcmstcmVsYXRlZCBvciBpbnN0YW5jZS1zcGVjaWZpYyBlcnJvciBvY2N1cnJlZCB3aGlsZSBlc3RhYmxpc2hpbmcgYSBjb25uZWN0aW9uIHRvIFNRTCBTZXJ2ZXIuIFRoZSBzZXJ2ZXIgd2FzIG5vdCBmb3VuZCBvciB3YXMgbm90IGFjY2Vzc2libGUuIFZlcmlmeSB0aGF0IHRoZSBpbnN0YW5jZSBuYW1lIGlzIGNvcnJlY3QgYW5kIHRoYXQgU1FMIFNlcnZlciBpcyBjb25maWd1cmVkIHRvIGFsbG93IHJlbW90ZSBjb25uZWN0aW9ucy4gKHByb3ZpZGVyOiBOYW1lZCBQaXBlcyBQcm92aWRlciwgZXJyb3I6IDQwIC0gQ291bGQgbm90IG9wZW4gYSBjb25uZWN0aW9uIHRvIFNRTCBTZXJ2ZXIpIj5yZXBvcnQgdGhpcyBlcnJvcjwvYT4gdG8gU1NXIGFuZCBpbmNsdWRlIHRoZSBmb2xsb3dpbmcgdGV4dDo8YnI+IC0gQSBuZXR3b3JrLXJlbGF0ZWQgb3IgaW5zdGFuY2Utc3BlY2lmaWMgZXJyb3Igb2NjdXJyZWQgd2hpbGUgZXN0YWJsaXNoaW5nIGEgY29ubmVjdGlvbiB0byBTUUwgU2VydmVyLiBUaGUgc2VydmVyIHdhcyBub3QgZm91bmQgb3Igd2FzIG5vdCBhY2Nlc3NpYmxlLiBWZXJpZnkgdGhhdCB0aGUgaW5zdGFuY2UgbmFtZSBpcyBjb3JyZWN0IGFuZCB0aGF0IFNRTCBTZXJ2ZXIgaXMgY29uZmlndXJlZCB0byBhbGxvdyByZW1vdGUgY29ubmVjdGlvbnMuIChwcm92aWRlcjogTmFtZWQgUGlwZXMgUHJvdmlkZXIsIGVycm9yOiA0MCAtIENvdWxkIG5vdCBvcGVuIGEgY29ubmVjdGlvbiB0byBTUUwgU2VydmVyKTwvcD4fAGdkZGTYXbcsDRN0kHjVAcvYlmskRrOACN8Lpd+lf5vZrXCvXA=="/>
</div>
<div>
<input id="__VIEWSTATEGENERATOR" name="__VIEWSTATEGENERATOR" type="hidden" value="4B80E9D1"/>
</div>
<div id="header" title="SSW - Rules to Better Exchange Server">
<a href="/ssw/">
<img alt="SSW Logo" height="100" id="sswlogo" src="/history/images/SSWLogo.png" width="130"/></a>
<a href="/ssw/Company/AboutUs.aspx">
<img alt="Microsoft Gold Partner Logo" height="41" id="msgoldpartner" src="/history/company/images/small_partnerlogo.png" width="110"/></a>
<h1>
        SSW - Rules to Better Exchange Server</h1>
</div>
<div id="mainContainer">
<div>
</div>
<p>
<span id="ctl00_mainContentPlaceHolder_SiteMapPath1"><a href="#ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"><img alt="Skip Navigation Links" height="0" src="/history/WebResource.axd" style="border-width:0px;" width="0"/></a><span><a href="/ssw/Default.aspx" title="Home">Home</a></span><span> &gt; </span><span><a href="/ssw/Standards/Default.aspx" title="SSW Standards">SSW Standards</a></span><span> &gt; </span><span><a href="/ssw/Standards/Rules/Default.aspx" title="Rules">Rules</a></span><span> &gt; </span><span>SSW - Rules to Better Exchange Server</span><a id="ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"></a></span>
</p>
<span id="ctl00_mainContentPlaceHolder_testimonial_lblError"><p style="font-size : 11px; color : #aaa">There was an error displaying the testimonials. Please <a href="mailto:info@s*w.com.au?Subject=Error displaying Testimonials&amp;body= URL: https://ssw.com.au/ssw/Standards/Rules/RulesToBetterExchangeServer.aspx

%0D Error: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)">report this error</a> to SSW and include the following text:<br/> - A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)</p></span>

 

    <div id="mainContent">
</div>
<div class="TableOfContents">
<b>Rules to Better Exchange Server</b>
<ol>
<li><a href="#EnableSearch">Do you enable the search?</a></li>
<li><a href="#custom-owa">Do you customise Outlook Web Access (OWA)?</a></li>
<li><a href="#redirection-to-HTTPS">Do you configure redirection to HTTPS (OWA)?</a></li>
</ol>
</div>
<ol>
<li>
<h2><a name="EnableSearch"></a>Do you enable the search?</h2>
<p>If search is not enabled you will get this message in OWA:</p>
<div class="greyBox">
<p>"Search results may take a long time to appear because Microsoft Exchange Search is unavailable. Results will not include matches in the email body."</p>
</div>
<p>There is an Microsoft KB regarding this error: <a class="external" href="/ssw/Redirect/StandardsRules/MicrosoftKB.htm" target="_blank">http://support.microsoft.com/kb/945077</a></p>
<p>This is how you fix it:</p>
<h4>To diagnose Exchange Search issues</h4>
<ol>
<li>Is the MSExchangeSearch service started on the Mailbox server? If Yes, go to
                        Step 2. If No, use the Services MMC snap-in to verify that the MSExchangeSearch
                        service is running:
                            <ul>
<li>Click <strong>Start</strong>, and then click <strong>Control Panel</strong></li>
<li>In <strong>Control Panel</strong>, double-click <strong>Administrative Tools</strong></li>
<li>In <strong>Administrative Tools</strong>, double-click <strong>Services</strong></li>
<li>Verify that the <strong>Microsoft Exchange Search Indexer</strong> service is started</li>
</ul>
</li>
<li>Is the <em>IndexEnabled</em> parameter configure to true for the mailbox database of the user?
                        Run the following command in the Exchange Management Shell to verify that the <em>IndexEnabled</em>
                        flag is configure to true: <strong>Get-MailboxDatabase |ft Name,IndexEnabled</strong> </li>
<li>Run the <strong>Test-ExchangeSearch</strong> command for the user: Test-ExchangeSearch -Identity ericphan[at]ssw.com.au</li>
<li>Check Event Viewer for search-related error messages. Check the <strong>Source: MSExchangeSearch Indexer</strong> and <strong>msftesql-Exchange</strong> events. For more information, follow the link on the event log.</li>
</ol>
<h4>To Rebuild the Full-Text Index Catalog Using the ResetSearchIndex.ps1 Script</h4>
<ol>
<li>Start the Exchange Management Shell.</li>
<li><em>ResetSearchIndex.ps1 -force -all</em><br/>
                        Wait a couple of minutes to the index be created</li>
<li>Run the command to verify if the index was created<br/>
<em>GetSearchIndexForDatabase -All</em></li>
</ol>
</li>
<li>
<h2><a name="custom-owa"></a>Do you customise Outlook Web Access (OWA)?</h2>
<p>It is possible to customise OWA, for example you can add change the colouring and add your company logo to the OWA logon page.</p>
<dl class="badImage">
<dt><img src="/history/Images/custom-owa-bad.jpg"/></dt>
<dd>Figure: Bad Example - OWA logon page doesn't clearly show it's from SSW</dd>
</dl>
<dl class="goodImage">
<dt><img src="/history/Images/custom-owa.jpg"/></dt>
<dd>Figure: Good Example - SSW OWA logon page with custom logo</dd>
</dl>
<p>The following Microsoft article explains how to customise OWA: <a href="http://technet.microsoft.com/en-us/library/ee633483(v=exchg.150).aspx" target="_blank">Customize the Outlook Web App Sign-In, Language Selection, and Error Pages</a>.</p>
</li>
<li>
<h2><a name="redirection-to-HTTPS"></a>Do you configure redirection to HTTPS (OWA)?</h2>
<p>Users like to access Outlook Web App (OWA) using well known address e.g. mail.ssw.com.au. Since OWA is running under a different URL they will face a 403 error. In such case it is good to redirect them to HTTPS address where OWA is actually running. E.g.</p>
<p>From http://mail.ssw.com.au</p>
<p>To https://mail.ssw.com.au<span class="highlight">/owa</span></p>
<dl class="image">
<dt><img alt="OWA redirection" src="/history/Images/owa-redirection.png"/></dt>
<dd>Figure: Bad example - 403 error is thrown where redirect is a better option </dd>
</dl>
<p>The following Microsoft articles explains how to configure redirection to HTTPS for OWA:</p>
<ul>
<li><a href="http://blogs.msdn.com/b/kaushal/archive/2013/05/23/http-to-https-redirects-on-iis-7-x-and-higher.aspx" target="_blank">HTTP to HTTPS redirects on IIS 7.x and higher</a></li>
<li><a href="http://support.microsoft.com/kb/975341" target="_blank">How to configure Exchange to redirect OWA HTTP requests to HTTPS requests in IIS 7</a></li>
</ul>
</li>
</ol>
<br/>
<h2>
        Acknowledgements</h2>
<p>
<a href="/ssw/Employees/EmployeesProfile.aspx?EmpID=AC">Adam Cogan</a><br/>
</p>
<br/>
</div>

<div id="footer">
<p class="callnow">Call Now +61 2 9953 3000</p>
<span class="copyright">© Copyright SSW 1990-2023. All Rights Reserved.</span>
<ul>
<li class="first"><a class="email" href="javascript:sendEmail('696E666F407373772E636F6D2E61753F7375626A6563743D466565646261636B20746F2053535726626F64793D687474703A2F2F7373772E636F6D2E61752F7373772F5374616E64617264732F52756C65732F52756C6573546F42657474657245786368616E67655365727665722E61737078')" id="ctl00_fC_feedbackHyperLink" tabindex="100">Feedback to SSW</a></li>
<li><a href="/ssw/Company/AboutUs.aspx">About SSW</a></li>
<li><a href="/ssw/Advertising/Default.aspx">Advertising</a></li>
<li class="last"><a href="/ssw/MenuMap.aspx">Sitemap</a></li>
</ul>
<span class="proudly"><a href="http://www.ssw.com.au">Proudly developed by SSW Sydney Web Design</a></span>
<!-- span class="proudlyAjax"><a href="/ssw/Standards/Rules/RulesToBetterWebsitesAdministration.aspx#AJAX">Powered by MS AJAX</a></span -->
<p class="serverName">Our website is under constant continuous deployment. Last deployment to AZIIS2022P03. Unable to retrieve changeset details.</p>
</div>
</form>
<!--Here's the Google Tracking Code, only available on external servers because we only need to track for external.-->



<!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com --><!-- / OptinMonster -->
<div style="visibility: visible;"><div></div><div><style>
        @-webkit-keyframes ww-88202b6a-141d-42a2-ad1f-84c28bacc3e8-launcherOnOpen {
          0% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }

          30% {
            -webkit-transform: translateY(-5px) rotate(2deg);
                    transform: translateY(-5px) rotate(2deg);
          }

          60% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }


          90% {
            -webkit-transform: translateY(-1px) rotate(0deg);
                    transform: translateY(-1px) rotate(0deg);

          }

          100% {
            -webkit-transform: translateY(-0px) rotate(0deg);
                    transform: translateY(-0px) rotate(0deg);
          }
        }
        @keyframes ww-88202b6a-141d-42a2-ad1f-84c28bacc3e8-launcherOnOpen {
          0% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }

          30% {
            -webkit-transform: translateY(-5px) rotate(2deg);
                    transform: translateY(-5px) rotate(2deg);
          }

          60% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }


          90% {
            -webkit-transform: translateY(-1px) rotate(0deg);
                    transform: translateY(-1px) rotate(0deg);

          }

          100% {
            -webkit-transform: translateY(-0px) rotate(0deg);
                    transform: translateY(-0px) rotate(0deg);
          }
        }

        @keyframes ww-88202b6a-141d-42a2-ad1f-84c28bacc3e8-widgetOnLoad {
          0% {
            opacity: 0;
          }
          100% {
            opacity: 1;
          }
        }

        @-webkit-keyframes ww-88202b6a-141d-42a2-ad1f-84c28bacc3e8-widgetOnLoad {
          0% {
            opacity: 0;
          }
          100% {
            opacity: 1;
          }
        }
      </style></div></div></body></html>