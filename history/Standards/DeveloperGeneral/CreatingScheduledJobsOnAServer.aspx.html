<html xmlns="http://www.w3.org/1999/xhtml"><head id="ctl00_Head1"><title>
	SSW Creating Scheduled Jobs on a Server
</title><meta content="en-au" http-equiv="Content-Language"/><meta content="IE=Edge" http-equiv="X-UA-Compatible"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta content="SSW, Consultants for software, database and website development, Software development, website development, web development, development, Access, SQL Server, ASP, .net, DotNet, Dot net, ASP.NET, VB.NET, C#, visual basic, database, website, web site, consultants, application, shopping cart, Internet, web, exchange server, sharepoint portal server, sharepoint team services,Database Design Australia, .Net development, sydney Australia, Web Design Australia, website design, web design, IT Services Australia, developers, Database Architect, Software architect, Software solution, Custom database solutions,Custom software solutions, downloads, Website design Australia, Online Database Australia, e-business, web development sydney, website development sydney, CRM, CRM Solution, SharePoint solution, MOSS solution, ebusiness, Sydney, Australia, Sydney Australia, Beijing China, Penang Malaysia, Sao Paulo Brazil" id="ctl00_keywords" name="keywords"/><meta content="Angular, React, Vue, Azure, Azure DevOps (was TFS), SharePoint, Office 365, Blazor, .NET, WebAPI, Dynamics 365, and SQL Server. We have software consultants located in Sydney, Brisbane, Melbourne, Newcastle, and China." name="description"/><meta content="SSW" name="author"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><link href="/history/css/Content.css" id="ctl00_Link1" media="screen" rel="stylesheet" type="text/css"/><link href="../../include/Adapters/CSS/Import.css" id="ctl00_AdaptersInvariantImportCSS" rel="stylesheet" type="text/css"/><link href="/history/css/Screen.css" id="ctl00_screenCSS" media="screen" rel="stylesheet" type="text/css"/><link href="/ssw/Images/icoSSW_2014.ico" rel="shortcut icon"/>














<link href="/ssw/include/googleSyntax/shCore.css" rel="stylesheet" type="text/css"/><link href="/ssw/include/googleSyntax/shThemeDefault.css" rel="stylesheet" type="text/css"/>

<link href="/history/css/Print.css" id="ctl00_printCSS" media="print" rel="stylesheet" type="text/css"/>
<!-- Start of pdi-ssw Zendesk Widget script -->

<!-- End of pdi-ssw Zendesk Widget script -->
<link href="https://a.omappapi.com/app/js/api.min.css" id="omapi-css" media="all" rel="stylesheet"/></head>
<body id="ctl00_MasterBody">
<form action="./CreatingScheduledJobsOnAServer.aspx" id="aspnetForm" method="post" name="aspnetForm">
<div>
<input id="__VIEWSTATE" name="__VIEWSTATE" type="hidden" value="/wEPDwUJNjUxODEzNDExD2QWAmYPZBYCAgMPZBYCAgEPZBYGAgMPPCsABQEADxYCHgdWaXNpYmxlaGRkAgUPPCsABQEADxYCHwBoZGQCBw88KwAFAQAPFgIfAGhkZGTthyAELMERgPJGUk2vq1Fiz4pR0mdC7YrVldrTIWoq7A=="/>
</div>
<div>
<input id="__VIEWSTATEGENERATOR" name="__VIEWSTATEGENERATOR" type="hidden" value="28702939"/>
</div>
<div id="header" title="SSW Creating Scheduled Jobs on a Server">
<a href="/ssw/">
<img alt="SSW Logo" height="100" id="sswlogo" src="/history/images/SSWLogo.png" width="130"/></a>
<a href="/ssw/Company/AboutUs.aspx">
<img alt="Microsoft Gold Partner Logo" height="41" id="msgoldpartner" src="/history/company/images/small_partnerlogo.png" width="110"/></a>
<h1>
        SSW Creating Scheduled Jobs on a Server</h1>
</div>
<div id="mainContainer">
<div>
</div>
<p>
<span id="ctl00_mainContentPlaceHolder_SiteMapPath1"><a href="#ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"><img alt="Skip Navigation Links" height="0" src="/history/WebResource.axd" style="border-width:0px;" width="0"/></a><span><a href="/ssw/Default.aspx" title="Home">Home</a></span><span> &gt; </span><span><a href="/ssw/Standards/Default.aspx" title="SSW Standards">SSW Standards</a></span><span> &gt; </span><span><a href="/ssw/Standards/DeveloperGeneral/Default.aspx" title="Developer General">Developer General</a></span><span> &gt; </span><span>SSW Creating Scheduled Jobs on a Server</span><a id="ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"></a></span>
</p>
<div class="clsTitle">
<h2>Standard for Creating Scheduled Jobs on a Server</h2>
<p>
	There are many methods of creating a scheduled job on a server. These include:
	</p><ol start="1">
<li>SQL Server Jobs</li>
<li>Creating a service (ie an Exe) for the task that will run based on a timer, or put the exe into a schedule.</li>
<li>Creating a web page that will run, called by a windows scheduled task (Start-&gt;Programs-&gt;Accessories-&gt;Scheduled Tasks. The scheduled task command line will be iexplore.exe http://myserver/mypage.asp?action=send or something similar.</li>
</ol>
<p></p>
<p>
	Of these choices, the preferred method is by using a web page (or web service if the page would not return any useful data). 
	This is because it is simpler, can be called remotely with no installation, and it is easy to pass query strings to the page 
	to elicit different responses (especially for debugging/testing purposes)

</p>
<p>
	The basic scheduled page should have the following features:
</p>
<ol start="1">
<li><b>A description/view mode</b>. The page that should display if the page is requested without an
     additional querystring. For example, if the scheduled job is to send out a
     batch of emails, the data should be dumped into a datagrid so that the
     user can preview the data or list of potential recipients. See figure 1
     below. This shows the recipients that are about to be sent a reminder
     email.
     
	<p class="MsoNormal"><b style="mso-bidi-font-weight:normal">Auto Email Send - Testing Page<o:p></o:p></b>
</p><p class="MsoNormal" style="margin-left:18.0pt"><o:p>
</o:p></p><div align="left">
<table border="1" cellpadding="0" cellspacing="0" class="MsoNormalTable" style="background:#E0E0E0;border-collapse:collapse">
<tbody><tr style="mso-yfti-irow:0">
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal"><b>FollowupID</b></p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal"><b>ReportID</b></p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal"><b>Email</b></p>
</td>
</tr>
<tr>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">6</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">1007</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal"><a href="/ssw/Employees/EmployeesProfile.aspx?EmpID=DDK">David Klein</a></p>
</td>
</tr>
<tr style="mso-yfti-irow:2">
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">13</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">1038</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">nhanley@n*tsafe2000.com (Note: Please change "*" in "n*t" to a "e")</p>
</td>
</tr>
<tr style="mso-yfti-irow:3">
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">15</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">1037</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal"><a href="/ssw/Employees/EmployeesProfile.aspx?EmpID=DDK">David Klein</a></p>
</td>
</tr>
<tr style="mso-yfti-irow:4">
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">17</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">1046</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">ddksup@s*w.com.au</p>
</td>
</tr>
<tr style="mso-yfti-irow:5">
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">18</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">1046</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">ddksup@s*w.com.au</p>
</td>
</tr>
<tr style="mso-yfti-irow:6">
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">19</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">1046</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">ddksup@s*w.com.au</p>
</td>
</tr>
<tr style="mso-yfti-irow:7">
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">20</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">1046</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">ddksup@s*w.com.au</p>
</td>
</tr>
<tr style="mso-yfti-irow:8">
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">7</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">1007</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">ddksup@s*w.com.au</p>
</td>
</tr>
<tr style="mso-yfti-irow:9">
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">9</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal">1016</p>
</td>
<td style="padding:.75pt .75pt .75pt .75pt">
<p class="MsoNormal"><a href="/ssw/Employees/EmployeesProfile.aspx?EmpID=DDK">David Klein</a></p>
</td>
</tr>
</tbody></table>
</div>
</li>
<li>
<b>An action.</b> The querystring should have an action parameter (e.g. sendemail.asp?action=send). This will carry out the action (in this case send) with the data as displayed in the description page (point 1).
 </li>
</ol>
<p>
	One very important point to note is that the page (ie
	iexplore.exe) will sit in the Windows Scheduled Tasks until manually
	interrupted. There are two ways around this:
</p>
<ol start="1">
<li>In the setup of the scheduled tasks, set it to terminate a process that runs for longer than XX minutes or hours. 
<p><img alt="" height="40" src="/history/Images/imgScheduledTaskTerminate.jpg" width="400"/></p>
</li>
<li>
Use JavaScript in the page which automatically closes the window when the action is performed e.g. when action=send is requested (be careful not to close the display page)
	<br/><br/>
	&lt;!--CLOSE THE WINDOW - Otherwise it will just sit there in scheduler. --&gt; <br/>
		&lt;script language = javascript&gt; <br/>
		window.opener = window; <br/>
		window.close(); <br/>
</li>
</ol>
<p>Here are some other important points:</p>
<ol>
<li>You do not need to have a display page when you are using a web service for pure maintenance. You can simply call the web service from the schedule, with the appropriate parameters.</li>
<li>You should do at least one test run on the scheduled task before leaving it (ie use the Run feature in the scheduled tasks list.</li>
<li>The scheduled task should be named with the ClientID as a prefix. E.g. SSWTaskShowOrphanedConnections.</li>
<li>You should also put in the %systemroot%/ScheduledTasks/readme.txt file, a description of your task, the frequency of its run, and the reason for its existence.</li>
</ol>
<h2>Acknowledgements</h2>
<p>
<a href="/ssw/Employees/employeesXML.aspx">David Klein</a>
</p>
<br/>
</div>

<div id="footer">
<p class="callnow">Call Now +61 2 9953 3000</p>
<span class="copyright">© Copyright SSW 1990-2023. All Rights Reserved.</span>
<ul>
<li class="first"><a class="email" href="javascript:sendEmail('696E666F407373772E636F6D2E61753F7375626A6563743D466565646261636B20746F2053535726626F64793D687474703A2F2F7373772E636F6D2E61752F7373772F5374616E64617264732F446576656C6F70657247656E6572616C2F4372656174696E675363686564756C65644A6F62734F6E415365727665722E61737078')" id="ctl00_fC_feedbackHyperLink" tabindex="100">Feedback to SSW</a></li>
<li><a href="/ssw/Company/AboutUs.aspx">About SSW</a></li>
<li><a href="/ssw/Advertising/Default.aspx">Advertising</a></li>
<li class="last"><a href="/ssw/MenuMap.aspx">Sitemap</a></li>
</ul>
<span class="proudly"><a href="http://www.ssw.com.au">Proudly developed by SSW Sydney Web Design</a></span>
<!-- span class="proudlyAjax"><a href="/ssw/Standards/Rules/RulesToBetterWebsitesAdministration.aspx#AJAX">Powered by MS AJAX</a></span -->
<p class="serverName">Our website is under constant continuous deployment. Last deployment to AZIIS2022P03. Unable to retrieve changeset details.</p>
</div>
<!--Here's the Google Tracking Code, only available on external servers because we only need to track for external.-->



<!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com --><!-- / OptinMonster -->
</div></form><div style="visibility: visible;"><div></div><div><style>
        @-webkit-keyframes ww-81f1a037-f926-4716-92c5-8497deaa5296-launcherOnOpen {
          0% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }

          30% {
            -webkit-transform: translateY(-5px) rotate(2deg);
                    transform: translateY(-5px) rotate(2deg);
          }

          60% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }


          90% {
            -webkit-transform: translateY(-1px) rotate(0deg);
                    transform: translateY(-1px) rotate(0deg);

          }

          100% {
            -webkit-transform: translateY(-0px) rotate(0deg);
                    transform: translateY(-0px) rotate(0deg);
          }
        }
        @keyframes ww-81f1a037-f926-4716-92c5-8497deaa5296-launcherOnOpen {
          0% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }

          30% {
            -webkit-transform: translateY(-5px) rotate(2deg);
                    transform: translateY(-5px) rotate(2deg);
          }

          60% {
            -webkit-transform: translateY(0px) rotate(0deg);
                    transform: translateY(0px) rotate(0deg);
          }


          90% {
            -webkit-transform: translateY(-1px) rotate(0deg);
                    transform: translateY(-1px) rotate(0deg);

          }

          100% {
            -webkit-transform: translateY(-0px) rotate(0deg);
                    transform: translateY(-0px) rotate(0deg);
          }
        }

        @keyframes ww-81f1a037-f926-4716-92c5-8497deaa5296-widgetOnLoad {
          0% {
            opacity: 0;
          }
          100% {
            opacity: 1;
          }
        }

        @-webkit-keyframes ww-81f1a037-f926-4716-92c5-8497deaa5296-widgetOnLoad {
          0% {
            opacity: 0;
          }
          100% {
            opacity: 1;
          }
        }
      </style></div></div></body></html>