<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
 <head id="ctl00_Head1">
  <script>
   (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NXDBVV');
  </script>
  <title>
   SSW Creating a SQL Server Profiler Trace
  </title>
  <meta content="en-au" http-equiv="Content-Language">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="SSW, Consultants for software, database and website development, Software development, website development, web development, development, Access, SQL Server, ASP, .net, DotNet, Dot net, ASP.NET, VB.NET, C#, visual basic, database, website, web site, consultants, application, shopping cart, Internet, web, exchange server, sharepoint portal server, sharepoint team services,Database Design Australia, .Net development, sydney Australia, Web Design Australia, website design, web design, IT Services Australia, developers, Database Architect, Software architect, Software solution, Custom database solutions,Custom software solutions, downloads, Website design Australia, Online Database Australia, e-business, web development sydney, website development sydney, CRM, CRM Solution, SharePoint solution, MOSS solution, ebusiness, Sydney, Australia, Sydney Australia, Beijing China, Penang Malaysia, Sao Paulo Brazil" id="ctl00_keywords" name="keywords">
  <meta content="Angular, React, Vue, Azure, Azure DevOps (was TFS), SharePoint, Office 365, Blazor, .NET, WebAPI, Dynamics 365, and SQL Server. We have software consultants located in Sydney, Brisbane, Melbourne, Newcastle, and China." name="description">
  <meta content="SSW" name="author">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <link href="/history/css/Content.css" id="ctl00_Link1" media="screen" rel="stylesheet" type="text/css">
  <link href="/history/css/Screen.css" id="ctl00_screenCSS" media="screen" rel="stylesheet" type="text/css">
  <link href="/ssw/Images/icoSSW_2014.ico" rel="shortcut icon">
  <link href="/ssw/include/googleSyntax/shCore.css" rel="stylesheet" type="text/css">
  <link href="/ssw/include/googleSyntax/shThemeDefault.css" rel="stylesheet" type="text/css">
  <link href="/history/css/Print.css" id="ctl00_printCSS" media="print" rel="stylesheet" type="text/css">
  <!-- Start of pdi-ssw Zendesk Widget script -->
  <!-- End of pdi-ssw Zendesk Widget script -->
  <link href="https://a.omappapi.com/app/js/api.min.css" id="omapi-css" media="all" rel="stylesheet">
 </head>
 <body id="ctl00_MasterBody" style="opacity: 1 !important;">
  <div style="
        line-height: 1.5;
        text-align: center; 
        font-size: 1.125rem; 
        color: #999;
        background-color: #333333;
        padding-top: 1.25rem;
        padding-bottom: 1.25rem;
        padding-right: 0.75rem;
        padding-left: 0.75rem;
    ">
   <div style="color: white; font-size: 2rem !important; font-weight: 600;">
    ⚠️ This page has been archived
   </div>
   <div style="color: white; font-size: 1.125rem !important; font-weight: 600;">
    <p style="color:white;">
     ✅ New page with updated info:
     <a href="https://www.ssw.com.au" style="color: white">
      ssw.com.au
     </a>
    </p>
   </div>
  </div>
  <noscript>
   <iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-NXDBVV" style="display:none;visibility:hidden" width="0">
   </iframe>
  </noscript>
  <form action="./creatingasqlserverprofilertrace.aspx" id="aspnetForm" method="post" name="aspnetForm">
   <div>
    <input id="__VIEWSTATE" name="__VIEWSTATE" type="hidden" value="/wEPDwUJNjUxODEzNDExD2QWAmYPZBYCAgMPZBYCAgEPZBYGAgMPPCsABQEADxYCHgdWaXNpYmxlaGRkAgUPPCsABQEADxYCHwBoZGQCBw88KwAFAQAPFgIfAGhkZGT7PdTfBNZZ9jBld9mN+aKE5062C6yLjp/9F1umw3f5Rw==">
   </div>
   <div>
    <input id="__VIEWSTATEGENERATOR" name="__VIEWSTATEGENERATOR" type="hidden" value="80868550">
   </div>
   <div id="mainContainer">
    <div>
    </div>
    <p>
     <span id="ctl00_mainContentPlaceHolder_SiteMapPath1">
      <a href="#ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink">
      </a>
      <span>
       <a href="/ssw/Default.aspx" title="Home">
        Home
       </a>
      </span>
      <span>
       &gt;
      </span>
      <span>
       <a href="/ssw/Standards/Default.aspx" title="SSW Standards">
        SSW Standards
       </a>
      </span>
      <span>
       &gt;
      </span>
      <span>
       <a href="/ssw/Standards/DeveloperSQLServer/Default.aspx" title="DeveloperSQLServer">
        DeveloperSQLServer
       </a>
      </span>
      <span>
       &gt;
      </span>
      <span>
       SSW Creating a SQL Server Profiler Trace
      </span>
      <a id="ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink">
      </a>
     </span>
    </p>
    <p>
     <b>
      Creating 
        a SQL Server Profiler Trace
     </b>
    </p>
    <h2>
     Summary
    </h2>
    &nbsp;
    <p>
    </p>
    This standard 
        shows how to create a SQL Server Profiler Trace so as to log object changes 
        in a Database.
    <p>
    </p>
    <p>
     The trace 
        must track any DDL (Database Definition Language) SQL statements for a 
        particular Database. This will not work with stored procedures, as they 
        are compiled, and their text is not shown on the trace. As such, we can 
        only track the creation and changes to stored procedures, not whether 
        they modify existing objects.
    </p>
    <p>
     NB: This 
        trace covers both batches and individual statements. However, this may 
        cause duplicates when there is a one-line operation to change the data. 
        Consequently, the duplicates in the data would have to be removed before 
        using for a process (eg to update two separate databases to the same structure)
    </p>
    <p>
     Running Profiler:
     <br>
     Run sqltrace.exe from a Run Dialog box to start.
     <br>
     Start a new Trace:
     <br>
     First, Create a New trace from the File menu.
    </p>
    <p>
    </p>
    <h2>
     GeneralTab
    </h2>
    <p>
    </p>
    <p>
     a. For the 
        trace name, use zsObjectChangeLog
    </p>
    <p>
     <img alt height="245" src="/history/standards/developer-sql-server/images/img-general-tab.gif" width="376">
    </p>
    <p>
     b. Enter 
        the Server Name
     <br>
     c. Check on "Capture to Table, and Enter for the destination table 
        properties:
     <br>
     1. The Server Name on which the database resides
     <br>
     2. Select the database for which the trace is being done (log file kept 
        in same database as the one being logged.)
     <br>
     3. Set the owner as db_owner
     <br>
     4. Leave the Table as zsObjectChangeLog
    </p>
    <p>
     <b>
      Events 
        Tab
     </b>
    </p>
    <p>
     <img alt height="289" src="/history/standards/developer-sql-server/images/img-events-tab.gif" width="267">
     <br>
     Select the TSQL event class, and add the
     <br>
     1. SQL:StmtComplete
     <br>
     2. SQL:BatchComplete
     <br>
     Events to the SQL Server Profiler Trace.
    </p>
    <p>
    </p>
    <h2>
     Data Columns Tab
    </h2>
    <p>
    </p>
    <p>
     &nbsp;
    </p>
    <img alt height="288" src="/history/standards/developer-sql-server/images/img-data-columns-tab.gif" width="268">
    <p>
     <br>
     Add the following columns to "Selected Data"
     <br>
     1. DatabaseID
     <br>
     2. Event Class
     <br>
     3. Text
     <br>
     4. Server Name
     <br>
     5. Host Name
     <br>
     6. Application Name
     <br>
     7. NT User Name
     <br>
     8. SQL User Name
     <br>
     9. StartTime
     <br>
     10. Duration
    </p>
    <p>
    </p>
    <h2>
     Filters 
        Tab
    </h2>
    <p>
    </p>
    <p>
     &nbsp;
    </p>
    <p>
     <img alt height="288" src="/history/standards/developer-sql-server/images/img-filters-tab.gif" width="268">
     <br>
     <br>
     a. Under Applications Criteria, enter: SQL Server Profiler%;%SQLAgent 
        - Alert%
     <br>
     b. To focus the select to a particular database (as we wish to do), we 
        need to determine the DatabaseID as per sysdatabases and enter it into 
        profiler. To do this:
     <br>
     1. Go to SQL Server Query Analyzer (Type isqlw.exe from the Run Prompt.).
     <br>
     2. Type SELECT DB_ID('YourDataBaseName') and Press F5 to run.
     <br>
     3. Use the value in the result window (in this case, 16), and enter it 
        into the DatabaseID Value Criteria.
     <br>
     4. The trace should also be restricted to DDL statements. To do this, 
        we must filter to only include CREATE, ALTER and DROP T-SQL statements. 
        Under the text criteria, Enter CREATE%;ALTER%;DROP%
     <br>
     <img alt height="288" src="/history/standards/developer-sql-server/images/img-filters-tab-end.gif" width="265">
     <br>
     c. Click OK, then Let the Trace Run!
     <br>
     End of Document
     <br>
    </p>
    <br>
   </div>
   <div id="footer">
    <p class="callnow">
     Call Now
     <a href="tel:+61299533000">
      +61 2 9953 3000
     </a>
    </p>
    <span class="copyright">
     &copy; Copyright SSW 1990-2024. All Rights Reserved.
    </span>
    <ul>
     <li class="first">
      <a class="email" href="javascript:sendEmail('696E666F407373772E636F6D2E61753F7375626A6563743D466565646261636B20746F2053535726626F64793D687474703A2F2F7373772E636F6D2E61752F7373772F5374616E64617264732F446576656C6F70657253514C5365727665722F6372656174696E676173716C73657276657270726F66696C657274726163652E61737078')" id="ctl00_fC_feedbackHyperLink" tabindex="100">
       Feedback to SSW
      </a>
     </li>
     <li>
      <a href="/ssw/Company/AboutUs.aspx">
       About SSW
      </a>
     </li>
     <li>
      <a href="/ssw/Advertising/Default.aspx">
       Advertising
      </a>
     </li>
     <li class="last">
      <a href="/ssw/MenuMap.aspx">
       Sitemap
      </a>
     </li>
    </ul>
    <span class="proudly">
     <a href="http://www.ssw.com.au">
      Proudly developed by SSW Sydney Web Design
     </a>
    </span>
    <!-- span class="proudlyAjax"><a href="/ssw/Standards/Rules/RulesToBetterWebsitesAdministration.aspx#AJAX">Powered by MS AJAX</a></span -->
    <p class="serverName">
     Our website is under constant continuous deployment. Last deployment to AZIIS2022P03. Unable to retrieve changeset details.
    </p>
   </div>
  </form>
  <!--Here's the Google Tracking Code, only available on external servers because we only need to track for external.-->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com -->
  <!-- / OptinMonster -->
  <div style="visibility: visible;">
   <div>
   </div>
   <div>
   </div>
  </div>
 </body>
</html>
