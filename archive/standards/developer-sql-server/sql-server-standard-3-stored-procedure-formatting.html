<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head id="ctl00_Head1">
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-NXDBVV");
    </script>
    <title>SSW SQL Stored Procedure Formatting Standard</title>
    <meta content="en-au" http-equiv="Content-Language" />
    <meta content="IE=Edge" http-equiv="X-UA-Compatible" />
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta
      content="SSW, Consultants for software, database and website development, Software development, website development, web development, development, Access, SQL Server, ASP, .net, DotNet, Dot net, ASP.NET, VB.NET, C#, visual basic, database, website, web site, consultants, application, shopping cart, Internet, web, exchange server, sharepoint portal server, sharepoint team services,Database Design Australia, .Net development, sydney Australia, Web Design Australia, website design, web design, IT Services Australia, developers, Database Architect, Software architect, Software solution, Custom database solutions,Custom software solutions, downloads, Website design Australia, Online Database Australia, e-business, web development sydney, website development sydney, CRM, CRM Solution, SharePoint solution, MOSS solution, ebusiness, Sydney, Australia, Sydney Australia, Beijing China, Penang Malaysia, Sao Paulo Brazil"
      id="ctl00_keywords"
      name="keywords"
    />
    <meta
      content="Angular, React, Vue, Azure, Azure DevOps (was TFS), SharePoint, Office 365, Blazor, .NET, WebAPI, Dynamics 365, and SQL Server. We have software consultants located in Sydney, Brisbane, Melbourne, Newcastle, and China."
      name="description"
    />
    <meta content="SSW" name="author" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <link
      href="/archive/css/Content.css"
      id="ctl00_Link1"
      media="screen"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="/archive/css/Screen.css"
      id="ctl00_screenCSS"
      media="screen"
      rel="stylesheet"
      type="text/css"
    />
    <link href="/archive/Images/icoSSW_2014.ico" rel="shortcut icon" />
    <link
      href="/archive/include/googleSyntax/shCore.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="/archive/include/googleSyntax/shThemeDefault.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="/archive/css/Print.css"
      id="ctl00_printCSS"
      media="print"
      rel="stylesheet"
      type="text/css"
    />
    <!-- Start of pdi-ssw Zendesk Widget script -->
    <!-- End of pdi-ssw Zendesk Widget script -->
    <link
      href="https://a.omappapi.com/app/js/api.min.css"
      id="omapi-css"
      media="all"
      rel="stylesheet"
    />
  </head>
  <body id="ctl00_MasterBody" style="opacity: 1 !important">
    <div
      style="
        line-height: 1.5;
        text-align: center;
        font-size: 1.125rem;
        color: #999;
        background-color: #333333;
        padding-top: 1.25rem;
        padding-bottom: 1.25rem;
        padding-right: 0.75rem;
        padding-left: 0.75rem;
      "
    >
      <div style="color: white; font-size: 2rem !important; font-weight: 600">
        ⚠️ This page has been archived
      </div>
      <div
        style="color: white; font-size: 1.125rem !important; font-weight: 600"
      >
        <p style="color: white">
          ✅ New page with updated info:
          <a href="https://www.ssw.com.au" style="color: white"> ssw.com.au </a>
        </p>
      </div>
    </div>
    <noscript>
      <iframe
        height="0"
        src="https://www.googletagmanager.com/ns.html?id=GTM-NXDBVV"
        style="display: none; visibility: hidden"
        width="0"
      >
      </iframe>
    </noscript>
    <form
      action="./SQLServerStandard_3_StoredProcedureFormatting.aspx"
      id="aspnetForm"
      method="post"
      name="aspnetForm"
    >
      <div>
        <input
          id="__VIEWSTATE"
          name="__VIEWSTATE"
          type="hidden"
          value="/wEPDwUKMTM2MDA3ODg2OQ9kFgJmD2QWAgIDD2QWAgIBD2QWCAIDDzwrAAUBAA8WAh4HVmlzaWJsZWhkZAIFDzwrAAUBAA8WAh8AaGRkAgcPPCsABQEADxYCHwBoZGQCCQ9kFgICAw9kFgICBg8PFgQeBFRleHQFmAg8cCBzdHlsZT0iZm9udC1zaXplIDogMTFweDsgY29sb3IgOiAjYWFhIj5UaGVyZSB3YXMgYW4gZXJyb3IgZGlzcGxheWluZyB0aGUgdGVzdGltb25pYWxzLiBQbGVhc2UgPEEgSFJFRj0ibWFpbHRvOmluZm9Acyp3LmNvbS5hdT9TdWJqZWN0PUVycm9yIGRpc3BsYXlpbmcgVGVzdGltb25pYWxzJmJvZHk9IFVSTDogaHR0cHM6Ly9zc3cuY29tLmF1L3Nzdy9TdGFuZGFyZHMvRGV2ZWxvcGVyU1FMU2VydmVyL1NRTFNlcnZlclN0YW5kYXJkXzNfU3RvcmVkUHJvY2VkdXJlRm9ybWF0dGluZy5hc3B4DQoNCiUwRCBFcnJvcjogQSBuZXR3b3JrLXJlbGF0ZWQgb3IgaW5zdGFuY2Utc3BlY2lmaWMgZXJyb3Igb2NjdXJyZWQgd2hpbGUgZXN0YWJsaXNoaW5nIGEgY29ubmVjdGlvbiB0byBTUUwgU2VydmVyLiBUaGUgc2VydmVyIHdhcyBub3QgZm91bmQgb3Igd2FzIG5vdCBhY2Nlc3NpYmxlLiBWZXJpZnkgdGhhdCB0aGUgaW5zdGFuY2UgbmFtZSBpcyBjb3JyZWN0IGFuZCB0aGF0IFNRTCBTZXJ2ZXIgaXMgY29uZmlndXJlZCB0byBhbGxvdyByZW1vdGUgY29ubmVjdGlvbnMuIChwcm92aWRlcjogTmFtZWQgUGlwZXMgUHJvdmlkZXIsIGVycm9yOiA0MCAtIENvdWxkIG5vdCBvcGVuIGEgY29ubmVjdGlvbiB0byBTUUwgU2VydmVyKSI+cmVwb3J0IHRoaXMgZXJyb3I8L2E+IHRvIFNTVyBhbmQgaW5jbHVkZSB0aGUgZm9sbG93aW5nIHRleHQ6PGJyPiAtIEEgbmV0d29yay1yZWxhdGVkIG9yIGluc3RhbmNlLXNwZWNpZmljIGVycm9yIG9jY3VycmVkIHdoaWxlIGVzdGFibGlzaGluZyBhIGNvbm5lY3Rpb24gdG8gU1FMIFNlcnZlci4gVGhlIHNlcnZlciB3YXMgbm90IGZvdW5kIG9yIHdhcyBub3QgYWNjZXNzaWJsZS4gVmVyaWZ5IHRoYXQgdGhlIGluc3RhbmNlIG5hbWUgaXMgY29ycmVjdCBhbmQgdGhhdCBTUUwgU2VydmVyIGlzIGNvbmZpZ3VyZWQgdG8gYWxsb3cgcmVtb3RlIGNvbm5lY3Rpb25zLiAocHJvdmlkZXI6IE5hbWVkIFBpcGVzIFByb3ZpZGVyLCBlcnJvcjogNDAgLSBDb3VsZCBub3Qgb3BlbiBhIGNvbm5lY3Rpb24gdG8gU1FMIFNlcnZlcik8L3A+HwBnZGRkh0zgz8FBR6dPqZsvG0x8W1Lqr+4Wp47HCOvqRxWfV3c="
        />
      </div>
      <div>
        <input
          id="__VIEWSTATEGENERATOR"
          name="__VIEWSTATEGENERATOR"
          type="hidden"
          value="A78642ED"
        />
      </div>
      <div id="mainContainer">
        <div></div>
        <p>
          <span id="ctl00_mainContentPlaceHolder_SiteMapPath1">
            <a href="#ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"> </a>
            <span>
              <a href="/archive" title="Home"> Home </a>
            </span>
            <span> &gt; </span>
            <span>
              <a href="/archive"> Archive </a>
            </span>
            <span> &gt; </span>
            <span>
              <a href="/archive/standards" title="SSW Standards">
                SSW Standards
              </a>
            </span>
            <span> &gt; </span>
            <span>
              <a
                href="/archive/standards/developer-sql-server"
                title="DeveloperSQLServer"
              >
                DeveloperSQLServer
              </a>
            </span>
            <span> &gt; </span>
            <span> SSW SQL Stored Procedure Formatting Standard </span>
            <a id="ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"> </a>
          </span>
        </p>
        <span id="ctl00_mainContentPlaceHolder_testimonial_lblError">
          <p style="font-size: 11px; color: #aaa">
            There was an error displaying the testimonials. Please
            <a
              href="mailto:info@s*w.com.au?Subject=Error displaying Testimonials&amp;body= URL: https://ssw.com.au/ssw/Standards/DeveloperSQLServer/SQLServerStandard_3_StoredProcedureFormatting.aspx

%0D Error: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)"
            >
              report this error
            </a>
            to SSW and include the following text:
            <br />
            - A network-related or instance-specific error occurred while
            establishing a connection to SQL Server. The server was not found or
            was not accessible. Verify that the instance name is correct and
            that SQL Server is configured to allow remote connections.
            (provider: Named Pipes Provider, error: 40 - Could not open a
            connection to SQL Server)
          </p>
        </span>
        <p>
          <b> SQL Server Stored Procedure Formatting Standard </b>
        </p>
        <p>
          This standard outlines the standard on formatting Stored Procedures
          within SQL Server. Use these standards when creating new Stored
          Procedures or if you find an older Stored Procedure that doesn't
          follow these standards within SSW.
        </p>
        <p>
          Note: Some developers may question the convention for naming stored
          proc parameters. We agree that this one is certainly open to debate.
          You need to ask yourself, "how will using this convention help my
          programmers?" and be prepared to drop the convention if the answer is
          "well actually it probably won't".
        </p>
        <p>
          We have always found control naming conventions useful on Access, VB
          and ASP forms. Therefore we bring them through to SQL Server - you may
          not. For example there is some question on the usefulness on using a
          str prefix on string variable types for Char, nChar, Varchar,
          nVarchar, Text, nText - in this case you really need to know more
          information than that (ie. the length), however you can at least tell
          whether you need single quotes in a WHERE clause (ie. WHERE ClientID='
          @strClientID '). Overall we believe this convention saves time because
          the datatypes are intuitive by their name.
          <br />
          <br />
        </p>
        <p>
          Do you agree with them all? Are we missing some?
          <a
            href="javascript:sendEmail('6D61696C746F3A496E666F407373772E636F6D2E61753F5375626A6563743D53514C20536572766572205374616E646172642053746F7265642050726F63656475726520466F726D617474696E67')"
          >
            Let us know
          </a>
          what you think.
        </p>
        <h2>Parameters</h2>
        <ol>
          <li>Each parameter is to go on a new line.</li>
          <li>
            A prefix of 'p' if the variable is passed in as a parameter i.e.
            @plngClientID
          </li>
          <li>
            A three-letter string that indicates the type of variable being used
          </li>
        </ol>
        <h2>Parameter Type String Example</h2>
        <p></p>
        <table class="clsSSWTable" width="90%">
          <tbody>
            <tr>
              <td width="30%">
                <div align="center">
                  <b> Parameter Type </b>
                </div>
              </td>
              <td width="10%">
                <div align="center">
                  <b> String </b>
                </div>
              </td>
              <td width="35%">
                <div align="center">
                  <b> Example </b>
                </div>
              </td>
              <td width="25%">
                <div align="center">
                  <b> We Don't use! </b>
                </div>
              </td>
            </tr>
            <tr>
              <td width="30%">Char, nChar, Varchar, nVarchar, Text, nText</td>
              <td width="10%">str</td>
              <td width="35%">@strEmail varchar(150)</td>
              <td width="25%">Chr chv chrn chvn txt txtn</td>
            </tr>
            <tr>
              <td width="30%">Datetime, SmallDatetime</td>
              <td width="10%">dte</td>
              <td width="35%">@dteDateCreated datetime</td>
              <td width="25%">dtm dts</td>
            </tr>
            <tr>
              <td width="30%">Tinyint, Smallint, Integer, Bigint</td>
              <td width="10%">int</td>
              <td width="35%">@intContactID int</td>
              <td width="25%">iny ins inb</td>
            </tr>
            <tr>
              <td width="30%">Bit</td>
              <td width="10%">bit</td>
              <td width="35%">@bitPrimaryContact bit</td>
              <td width="25%"></td>
            </tr>
            <tr>
              <td width="30%">Real</td>
              <td width="10%">sng</td>
              <td width="35%">@sngTotal real</td>
              <td width="25%">rea</td>
            </tr>
            <tr>
              <td width="30%">Float</td>
              <td width="10%">dbl</td>
              <td width="35%">@dblLength float</td>
              <td width="25%">flt</td>
            </tr>
            <tr>
              <td width="30%">Decimal</td>
              <td width="10%">dec</td>
              <td width="35%">@decLength Decimal(4,2)</td>
              <td width="25%"></td>
            </tr>
            <tr>
              <td width="30%">SmallMoney, Money</td>
              <td width="10%">cur</td>
              <td width="35%">@curTotal money</td>
              <td width="25%">mny mns</td>
            </tr>
            <tr>
              <td width="30%">Binary, varBinary</td>
              <td width="10%">bin</td>
              <td width="35%">@binContract binary</td>
              <td width="25%">biv</td>
            </tr>
            <tr>
              <td width="30%">Image</td>
              <td width="10%">img</td>
              <td width="35%">@imgLogo image</td>
              <td width="25%"></td>
            </tr>
            <tr>
              <td width="30%">Timestamp</td>
              <td width="10%">tsp</td>
              <td width="35%">@tspCurrent timestamp</td>
              <td width="25%"></td>
            </tr>
            <tr>
              <td width="30%">UniqueIdentifier</td>
              <td width="10%">guid</td>
              <td width="35%">@guidOrderID Uniqueidentifier</td>
              <td width="25%"></td>
            </tr>
            <tr>
              <td width="30%">Sql_Variant</td>
              <td width="10%">var</td>
              <td width="35%">@varPrice sql_Variant</td>
              <td width="25%"></td>
            </tr>
            <tr>
              <td width="30%">Cursor</td>
              <td width="10%">crs</td>
              <td width="35%">@crsInventory Cursor</td>
              <td width="25%"></td>
            </tr>
            <tr>
              <td width="30%">Table</td>
              <td width="10%">tab</td>
              <td width="35%">
                @tabMyTable table ( entryid int not null , lname varchar(16) not
                null )
              </td>
              <td width="25%"></td>
            </tr>
          </tbody>
        </table>
        <p>
          <br />
        </p>
        <h2>Example</h2>
        <p>
          -- Description Call this proc for every Bounced Email
          <br />
          -- Date        v1 11/11/1999 AC
          <br />
          -- Modified    v2 14/11/1999 DDK
          <br />
          -- Modified    v3 13/12/1999 DDK
        </p>
        <p>CREATE PROC procClientBouncedEmailUpdate</p>
        <blockquote>
          <p>
            @pstrClientID nvarchar(6),
            <br />
            @pintContactID int,
            <br />
            @pstrBouncedEmail varchar(50)
          </p>
        </blockquote>
        <p>AS</p>
        <p>-- Continued below...</p>
        <h2>New Lines</h2>
        <p></p>
        <ol>
          <li>
            Start a new line before each keyword ie. SELECT, FROM, WHERE, ORDER
            BY.
          </li>
          <li>
            Each field in a SELECT/UPDATE statement is to go on a new line
          </li>
          <li>Each item is to be indented. (See below)</li>
          <li>Place each condition of a WHERE clause on a new line.</li>
        </ol>
        <p></p>
        <h2>Example</h2>
        <dl class="badImage">
          <dt>
            <p>
              UPDATE ClientContact SET DateBouncedLast = getdate(), BouncedTimes
              = 1, BouncedEmail = @pstrBouncedEmail FROM ClientContact WHERE
              Email = @pstrBouncedEmail AND ContactID = @pintContactID
            </p>
            <p>
              RETURN
              <br />
            </p>
          </dt>
          <dd>Figure: Example of bad format</dd>
        </dl>
        <dl class="goodImage">
          <dt>
            <p>
              UPDATE ClientContact
              <br />
              SET DateBouncedLast = getdate(),
              <br />
              BouncedTimes = 1,
              <br />
              BouncedEmail = @pstrBouncedEmail
              <br />
              FROM ClientContact
              <br />
              WHERE Email = @pstrBouncedEmail
              <br />
              AND ContactID = @pintContactID
            </p>
            <p>
              RETURN
              <br />
            </p>
          </dt>
          <dd>Figure: Example of good format</dd>
        </dl>
        <h2>Acknowledgments</h2>
        <p>
          <a href="https://ssw.com.au/people/adam-cogan/"> Adam Cogan </a>
        </p>
        <br />
      </div>
      <div id="footer">
        <p class="callnow">
          Call Now
          <a href="tel:+61299533000"> +61 2 9953 3000 </a>
        </p>
        <span class="copyright">
          © Copyright SSW 1990-2024. All Rights Reserved.
        </span>
        <ul>
          <li class="first">
            <a
              class="email"
              href="javascript:sendEmail('696E666F407373772E636F6D2E61753F7375626A6563743D466565646261636B20746F2053535726626F64793D687474703A2F2F7373772E636F6D2E61752F7373772F5374616E64617264732F446576656C6F70657253514C5365727665722F53514C5365727665725374616E646172645F335F53746F72656450726F636564757265466F726D617474696E672E61737078')"
              id="ctl00_fC_feedbackHyperLink"
              tabindex="100"
            >
              Feedback to SSW
            </a>
          </li>
          <li>
            <a href="/ssw/Company/AboutUs.aspx"> About SSW </a>
          </li>
          <li>
            <a href="/ssw/Advertising/Default.aspx"> Advertising </a>
          </li>
          <li class="last">
            <a href="/ssw/MenuMap.aspx"> Sitemap </a>
          </li>
        </ul>
        <span class="proudly">
          <a href="http://www.ssw.com.au">
            Proudly developed by SSW Sydney Web Design
          </a>
        </span>
        <!-- span class="proudlyAjax"><a href="/ssw/Standards/Rules/RulesToBetterWebsitesAdministration.aspx#AJAX">Powered by MS AJAX</a></span -->
        <p class="serverName">
          Our website is under constant continuous deployment. Last deployment
          to AZIIS2022P03. Unable to retrieve changeset details.
        </p>
      </div>
    </form>
    <!--Here's the Google Tracking Code, only available on external servers because we only need to track for external.-->
    <!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com -->
    <!-- / OptinMonster -->
    <div style="visibility: visible">
      <div></div>
      <div></div>
    </div>
  </body>
</html>
