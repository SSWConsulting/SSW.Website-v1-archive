<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
 <head id="ctl00_Head1">
  <script>
   (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-NXDBVV");
  </script>
  <title>
   SSW SharePoint VM Development
  </title>
  <meta content="en-au" http-equiv="Content-Language">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="SSW, Consultants for software, database and website development, Software development, website development, web development, development, Access, SQL Server, ASP, .net, DotNet, Dot net, ASP.NET, VB.NET, C#, visual basic, database, website, web site, consultants, application, shopping cart, Internet, web, exchange server, sharepoint portal server, sharepoint team services,Database Design Australia, .Net development, sydney Australia, Web Design Australia, website design, web design, IT Services Australia, developers, Database Architect, Software architect, Software solution, Custom database solutions,Custom software solutions, downloads, Website design Australia, Online Database Australia, e-business, web development sydney, website development sydney, CRM, CRM Solution, SharePoint solution, MOSS solution, ebusiness, Sydney, Australia, Sydney Australia, Beijing China, Penang Malaysia, Sao Paulo Brazil" id="ctl00_keywords" name="keywords">
  <meta content="Angular, React, Vue, Azure, Azure DevOps (was TFS), SharePoint, Office 365, Blazor, .NET, WebAPI, Dynamics 365, and SQL Server. We have software consultants located in Sydney, Brisbane, Melbourne, Newcastle, and China." name="description">
  <meta content="SSW" name="author">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <link href="/archive/css/Content.css" id="ctl00_Link1" media="screen" rel="stylesheet" type="text/css">
  <link href="/archive/css/Screen.css" id="ctl00_screenCSS" media="screen" rel="stylesheet" type="text/css">
  <link href="/archive/Images/icoSSW_2014.ico" rel="shortcut icon">
  <link href="/archive/include/googleSyntax/shCore.css" rel="stylesheet" type="text/css">
  <link href="/archive/include/googleSyntax/shThemeDefault.css" rel="stylesheet" type="text/css">
  <link href="/archive/css/Print.css" id="ctl00_printCSS" media="print" rel="stylesheet" type="text/css">
  <!-- Start of pdi-ssw Zendesk Widget script -->
  <!-- End of pdi-ssw Zendesk Widget script -->
  <link href="https://a.omappapi.com/app/js/api.min.css" id="omapi-css" media="all" rel="stylesheet">
 </head>
 <body id="ctl00_MasterBody" style="opacity: 1 !important">
  <div style="
        line-height: 1.5;
        text-align: center;
        font-size: 1.125rem;
        color: #999;
        background-color: #333333;
        padding-top: 1.25rem;
        padding-bottom: 1.25rem;
        padding-right: 0.75rem;
        padding-left: 0.75rem;
      ">
   <div style="color: white; font-size: 2rem !important; font-weight: 600">
    ⚠️ This page has been archived
   </div>
   <div style="color: white; font-size: 1.125rem !important; font-weight: 600">
    <p style="color: white">
     ✅ New page with updated info:
     <a href="https://www.ssw.com.au" style="color: white">
      ssw.com.au
     </a>
    </p>
   </div>
  </div>
  <noscript>
   <iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-NXDBVV" style="display: none; visibility: hidden" width="0">
   </iframe>
  </noscript>
  <form action="./VMDevelopment.aspx" id="aspnetForm" method="post" name="aspnetForm">
   <div>
    <input id="__VIEWSTATE" name="__VIEWSTATE" type="hidden" value="/wEPDwULLTE3MTA1NjQwMzQPZBYCZg9kFgICAw9kFgICAQ9kFgYCAw88KwAFAQAPFgIeB1Zpc2libGVoZGQCBQ88KwAFAQAPFgIfAGhkZAIHDzwrAAUBAA8WAh8AaGRkZFRz+GtnR1zmXGk6KfHOXmA/JSdzmXf8cpq5itAuYQzL">
   </div>
   <div>
    <input id="__VIEWSTATEGENERATOR" name="__VIEWSTATEGENERATOR" type="hidden" value="809D8800">
   </div>
   <div id="mainContainer">
    <div>
    </div>
    <p>
     <span id="ctl00_mainContentPlaceHolder_SiteMapPath1">
      <a href="#ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink">
      </a>
      <span>
       <a href="/archive" title="Home">
        Home
       </a>
      </span>
      <span>
       &gt;
      </span>
      <span>
       <a href="/archive/standards" title="SSW Standards">
        SSW Standards
       </a>
      </span>
      <span>
       &gt;
      </span>
      <span>
       <a href="/archive/standards/developer-sharepoint/" title="DeveloperSharePoint">
        DeveloperSharePoint
       </a>
      </span>
      <span>
       &gt;
      </span>
      <span>
       SSW SharePoint VM Development
      </span>
      <a id="ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink">
      </a>
     </span>
    </p>
    <!--
	This is the main document.
	-->
    <div class="TableOfContents">
     <h3>
      SharePoint VM Development
     </h3>
     <ol>
      <li>
       <a href="#useVM">
        Do you know to develop inside a VM?
       </a>
      </li>
      <li>
       <a href="#VMimages">
        What are the different images available?
       </a>
      </li>
      <li>
       <a href="#createmyownSharePointVM">
        How do I create my own SharePoint VM to play with?
       </a>
      </li>
      <li>
       <a href="#createaanewSysprepVM">
        How do I update and create a new version of the Sysprep VM ?
       </a>
      </li>
      <li>
       <a href="#vmcontents">
        What does a SharePoint image need?
       </a>
      </li>
      <li>
       <a href="#sysprepprocesswork">
        How does the sysprep process work, what does the scripts do? Why
                is this process so complicated ?
       </a>
      </li>
     </ol>
    </div>
    <p>
     Do you agree with them all? Are we missing some?
     <a href="javascript:sendEmail('6D61696C746F3A496E666F407373772E636F6D2E61753F5375626A6563743D54686525323042657374253230546F6F6C73253230466F7225323045786368616E6765253230536572766572')">
      Let us know
     </a>
     what you think.
    </p>
    <ol>
     <li>
      <a name="useVM">
      </a>
      <h2>
       Do you know to develop inside a VM?
      </h2>
      <p>
       All SharePoint customization and development must be done on a
              Virtual Machine.
      </p>
      <a href="/ssw/Standards/Rules/RulesToBetterSharePoint.aspx#DevInsideVM">
       More info on setting up SharePoint VM
      </a>
     </li>
     <li>
      <a name="VMimages">
      </a>
      <h2>
       What are the different Virtual Machine images available?
      </h2>
      <p>
       We have three types of VM images around the office.
      </p>
      <ol>
       <li>
        The master.vhd is for upgrading future VMs and sysprep VM's are
                built from the master.vhd
        <br>
        The
        <b>
         master.vhd is versioned (e.g. master_v8.vhd)
        </b>
        to track which version it is, and to assist us in upgrading the
                master image.
       </li>
       <li>
        The sysprep.vhd is the one that we use to create a new
                SharePoint server
        <br>
        When you run the sysprep.vhd it will create a new SharePoint
                server. Always make a copy of this to your own machine. The
        <b>
         sysprep.vhd is versioned (e.g. sysprep_v8.vhd)
        </b>
       </li>
       <li>
        You may find various other VM's created from sysprep.vhd and
                used for various projects or experiments
        <br>
        These images are usually renamed but kept the original version
                number that it was created from. (e.g. sswsp_v8.vhd)
       </li>
      </ol>
     </li>
     <li>
      <a name="createmyownSharePointVM">
      </a>
      <h2>
       How do I create my own SharePoint VM?
      </h2>
      <p>
       When you want to create a SharePoint environment, you would need
              to create a new Virtual Machine from the SysPrep image.
      </p>
      <ol>
       <li>
        Make a copy of the latest version of sysprep.vhd and
        <b>
         do not run the base one
        </b>
        <ol>
         <li>
          Rename sysprep.vhd so that it says what you are using it
                    for.
          <br>
          e.g. client_project_v7.vhd
         </li>
         <li>
          You will retain the version number so can we know from which
                    sysprep.vhd it was made from
         </li>
        </ol>
       </li>
       <li>
        In Hyper-V or Virtual PC, you create a new VM and link it to
                your copy of the sysprep.vhd
        <ol>
         <li>
          You will need to allocate 2GB of RAM for this image
         </li>
         <li>
          You will need plenty of hard drive space (at least 25GB to
                    30GB)
         </li>
         <li>
          You will also need time - it is best to run this on a
                    different machine if you plan to use your laptop at the same
                    time when you are setting up this Virtual Machine
         </li>
        </ol>
       </li>
       <li>
        You want to have the undo disk off initially, so that the
                installation commits changes directly to the VHD. Start the VM
       </li>
       <!--SSW Code Auditor - Ignore next line(HTML)-->
       <li>
        Once the VM starts up, you will be asked to log on - use our
                SharePoint dev password for the administrator account
       </li>
       <li>
        Setup scripts will run for the administrator - this will rename
                the machine and install SQL Server
       </li>
       <!--SSW Code Auditor - Ignore next line(HTML)-->
       <li>
        When the process is completed, the machine will restart, and
                prompt you to logon again as the MOSSFarm account - use our
                SharePoint dev password for the MOSSFarm account
       </li>
       <li>
        A second set of setup scripts will run for this account - this
                will install MOSS, SP1
       </li>
       <li>
        When this is done, power down the VM, and commit all changes to
                disk
        <ol>
         <li>
          Consider setting up either snapshots or undo-disk at this
                    point.
         </li>
        </ol>
       </li>
      </ol>
     </li>
     <li>
      <a name="vmcontents">
      </a>
      <h2>
       What does a SharePoint image need?
      </h2>
      <p>
       As a minumum, the SharePoint image needs:
      </p>
      <ol>
       <li>
        Windows Server 2003 or 2008
       </li>
       <li>
        SQL Server 2005 sp1
       </li>
       <li>
        WSS 3.0 sp1
       </li>
       <li>
        MOSS 2007 sp1
       </li>
       <li>
        MS Office SharePoint Designer sp1
       </li>
       <li>
        Visual Studio .NET 2005 or 2008
       </li>
      </ol>
     </li>
     <li>
      <a name="createaanewSysprepVM">
      </a>
      <h2>
       How do I update and create a new version of the Sysprep VM?
      </h2>
      <p>
       When MS releases a new service pack, or new Windows update, we
              install these to the master image and create a new version of the
              Sysprep image for future VMs.
      </p>
      <ol>
       <li>
        Update SQL Server service packs
       </li>
       <li>
        Update Windows Server 2003 service packs
       </li>
       <li>
        Update Windows
       </li>
       <li>
        Update VS.NET service packs
       </li>
       <li>
        Update SharePoint service packs
       </li>
       <li>
        Update MS Office SharePoint Designer service packs
       </li>
      </ol>
      <p>
       To create a new VM:
      </p>
      <ol>
       <li>
        Make a copy of the master.vhd, rename it to the next version
       </li>
       <li>
        Create a VM using this new vhd
       </li>
       <li>
        Copy additional setup files to D:\install\
       </li>
       <li>
        Modify the scripts in D:\scripts\
       </li>
       <li>
        When finished, power down the VM. Make a copy of this and rename
                it to sysprep-vNext.vhd
       </li>
       <li>
        Create a new VM using this new vhd
       </li>
       <li>
        Start it up, and then run the sysprep command in D:\sysprep\
       </li>
       <li>
        This will generalize the computer's settings and shut it down
       </li>
       <li>
        Don't start up the VM again - or it'll run the start up scripts
       </li>
       <li>
        Zz old copies of the master.vhd and sysprep.vhd
       </li>
      </ol>
     </li>
     <li>
      <a name="sysprepprocesswork">
      </a>
      <h2>
       How does the sysprep process work, what does the scripts do? Why
              is this process so complicated ?
      </h2>
      <ol>
       <li>
        SharePoint server can't be renamed after SharePoint is installed
       </li>
       <li>
        Multiple VM's with the same name can't be powered up in the same
                network
       </li>
       <li>
        So the master.vhd contains:
        <ol>
         <li>
          Windows 2003 server SP2
         </li>
         <li>
          Visual Studio .NET 2005
         </li>
         <li>
          Microsoft Office SharePoint Designer
         </li>
        </ol>
       </li>
       <li>
        When sysprep is ran on the master.vhd, it generalises Windows
                2003 server (generate new machine guide, rename computer, etc),
                the scripts that run also puts "administrator" into the registry
                so that'd be the name of the next login prompt. A vhd that is in
                this state is the "sysprep'ed" vhd
       </li>
       <li>
        When it restarts and the user logs in with administrator, it
                then runs the script to install
        <ol>
         <li>
          SQL Server 2005
         </li>
         <li>
          Puts MossFarm account into registry
         </li>
        </ol>
       </li>
       <!--SSW Code Auditor - Ignore next line(HTML)-->
       <li>
        After restart - log on with MossFarm account and run the scripts
                to install
        <ol>
         <li>
          SharePoint 2007 sp1
         </li>
        </ol>
       </li>
       <li>
        Runs Moss\Post_Build.cmd
       </li>
      </ol>
     </li>
    </ol>
    <h2>
     Acknowledgements
    </h2>
    <p>
     <a href="/ssw/Employees/EmployeesProfile.aspx?EmpID=JL">
      John Liu
     </a>
     <br>
    </p>
    <br>
   </div>
   <div id="footer">
    <p class="callnow">
     Call Now
     <a href="tel:+61299533000">
      +61 2 9953 3000
     </a>
    </p>
    <span class="copyright">
     &copy; Copyright SSW 1990-2024. All Rights Reserved.
    </span>
    <ul>
     <li class="first">
      <a class="email" href="javascript:sendEmail('696E666F407373772E636F6D2E61753F7375626A6563743D466565646261636B20746F2053535726626F64793D687474703A2F2F7373772E636F6D2E61752F7373772F5374616E64617264732F446576656C6F7065725368617265506F696E742F564D446576656C6F706D656E742E61737078')" id="ctl00_fC_feedbackHyperLink" tabindex="100">
       Feedback to SSW
      </a>
     </li>
     <li>
      <a href="/ssw/Company/AboutUs.aspx">
       About SSW
      </a>
     </li>
     <li>
      <a href="/ssw/Advertising/Default.aspx">
       Advertising
      </a>
     </li>
     <li class="last">
      <a href="/ssw/MenuMap.aspx">
       Sitemap
      </a>
     </li>
    </ul>
    <span class="proudly">
     <a href="http://www.ssw.com.au">
      Proudly developed by SSW Sydney Web Design
     </a>
    </span>
    <!-- span class="proudlyAjax"><a href="/ssw/Standards/Rules/RulesToBetterWebsitesAdministration.aspx#AJAX">Powered by MS AJAX</a></span -->
    <p class="serverName">
     Our website is under constant continuous deployment. Last deployment
          to AZIIS2022P03. Unable to retrieve changeset details.
    </p>
   </div>
  </form>
  <!--Here's the Google Tracking Code, only available on external servers because we only need to track for external.-->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com -->
  <!-- / OptinMonster -->
  <div style="visibility: visible">
   <div>
   </div>
   <div>
   </div>
  </div>
 </body>
</html>
