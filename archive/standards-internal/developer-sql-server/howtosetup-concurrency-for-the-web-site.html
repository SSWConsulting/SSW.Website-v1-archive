<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head id="ctl00_Head1">
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
          "gtm.start": new Date().getTime(),
          event: "gtm.js",
        });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-NXDBVV");
    </script>
    <title>How To Setup Concurrency for the Web Site</title>
    <meta content="en-au" http-equiv="Content-Language" />
    <meta content="IE=Edge" http-equiv="X-UA-Compatible" />
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta
      content="SSW, Consultants for software, database and website development, Software development, website development, web development, development, Access, SQL Server, ASP, .net, DotNet, Dot net, ASP.NET, VB.NET, C#, visual basic, database, website, web site, consultants, application, shopping cart, Internet, web, exchange server, sharepoint portal server, sharepoint team services,Database Design Australia, .Net development, sydney Australia, Web Design Australia, website design, web design, IT Services Australia, developers, Database Architect, Software architect, Software solution, Custom database solutions,Custom software solutions, downloads, Website design Australia, Online Database Australia, e-business, web development sydney, website development sydney, CRM, CRM Solution, SharePoint solution, MOSS solution, ebusiness, Sydney, Australia, Sydney Australia, Beijing China, Penang Malaysia, Sao Paulo Brazil"
      id="ctl00_keywords"
      name="keywords"
    />
    <meta
      content="Angular, React, Vue, Azure, Azure DevOps (was TFS), SharePoint, Office 365, Blazor, .NET, WebAPI, Dynamics 365, and SQL Server. We have software consultants located in Sydney, Brisbane, Melbourne, Newcastle, and China."
      name="description"
    />
    <meta content="SSW" name="author" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <link
      href="/archive/css/Content.css"
      id="ctl00_Link1"
      media="screen"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="/archive/css/Screen.css"
      id="ctl00_screenCSS"
      media="screen"
      rel="stylesheet"
      type="text/css"
    />
    <link href="/archive/images/icoSSW_2014.ico" rel="shortcut icon" />
    <link
      href="/archive/include/googleSyntax/shCore.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="/archive/include/googleSyntax/shThemeDefault.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="/archive/css/Print.css"
      id="ctl00_printCSS"
      media="print"
      rel="stylesheet"
      type="text/css"
    />
    <!-- Start of pdi-ssw Zendesk Widget script -->
    <!-- End of pdi-ssw Zendesk Widget script -->
    <link
      href="https://a.omappapi.com/app/js/api.min.css"
      id="omapi-css"
      media="all"
      rel="stylesheet"
    />
  </head>

  <body id="ctl00_MasterBody" style="opacity: 1 !important">
    <div
      style="
        line-height: 1.5;
        text-align: center;
        font-size: 1.125rem;
        color: #999;
        background-color: #333333;
        padding-top: 1.25rem;
        padding-bottom: 1.25rem;
        padding-right: 0.75rem;
        padding-left: 0.75rem;
      "
    >
      <div style="color: white; font-size: 2rem !important; font-weight: 600">
        ⚠️ This page has been archived
      </div>
      <div
        style="color: white; font-size: 1.125rem !important; font-weight: 600"
      >
        <p style="color: white">
          ✅ New page with updated info:
          <a href="https://www.ssw.com.au" style="color: white"> ssw.com.au </a>
        </p>
      </div>
    </div>
    <noscript>
      <iframe
        height="0"
        src="https://www.googletagmanager.com/ns.html?id=GTM-NXDBVV"
        style="display: none; visibility: hidden"
        width="0"
      >
      </iframe>
    </noscript>
    <form
      action="./HOWTOSetupConcurrencyForTheWebSite.aspx"
      id="aspnetForm"
      method="post"
      name="aspnetForm"
    >
      <div>
        <input
          id="__VIEWSTATE"
          name="__VIEWSTATE"
          type="hidden"
          value="/wEPDwUJNjUxODEzNDExD2QWAmYPZBYCAgMPZBYCAgEPZBYGAgMPPCsABQEADxYCHgdWaXNpYmxlaGRkAgUPPCsABQEADxYCHwBoZGQCBw88KwAFAQAPFgIfAGhkZGR6ZDzcmJoKFKnSwH231VfppryFF0stSazEqZvtqBAamQ=="
        />
      </div>
      <div>
        <input
          id="__VIEWSTATEGENERATOR"
          name="__VIEWSTATEGENERATOR"
          type="hidden"
          value="7BB84B2E"
        />
      </div>
      <div id="mainContainer">
        <div></div>
        <p>
          <span id="ctl00_mainContentPlaceHolder_SiteMapPath1">
            <a href="#ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"> </a>
            <span>
              <a href="/archive" title="Home"> Home </a>
            </span>
            <span> &gt; </span>
            <span>
              <a
                href="/archive/standards-internal/"
                title="SSW Standards Internal"
              >
                SSW Standards Internal
              </a>
            </span>
            <span> &gt; </span>
            <span>
              <a
                href="/archive/standards-internal/developer-sql-server"
                title="Developer SQL Server"
              >
                Developer SQL Server
              </a>
            </span>
            <span> &gt; </span>
            <span> How To Setup Concurrency for the Web Site </span>
            <a id="ctl00_mainContentPlaceHolder_SiteMapPath1_SkipLink"> </a>
          </span>
        </p>
        <p>
          <a>
            Just like in an Access database, it is important to setup
            Concurrency on SQL Server tables and add code to our web sites so
            that they handle Concurrency. Usually this would be done with a
            Timestamp field. But we have decided to use an integer field called
            Concurrency that would be incremented whenever a record is updated.
          </a>
        </p>
        <a> </a>
        <a> </a>
        <table
          cellpadding="2"
          cellspacing="2"
          class="clsSSWTableOfContents"
          style="{width:100%}"
          summary="Index"
        >
          <tbody>
            <tr>
              <td>
                <b> Steps for Setting up Concurrency for the Web Site </b>
                <br />
                <a href="#AddConcurrencyField"> 1. </a>
                Add the Concurrency field to the Table
                <br />
                <a href="#UpdateSelectStoredProcedure"> 2. </a>
                Update the Select Stored Procedure
                <br />
                <!-- this page was incomplete.. 
				<a href="#UpdateUpdateStoredProcedure">3.</a> Update the Update Stored 
                Procedure<br>
				<a href="#AddCodeToWebSite">4.</a> Add Code to the Web Site to handle 
                this <br>
                -->
              </td>
            </tr>
          </tbody>
        </table>
        <ol>
          <a> </a>
          <li>
            <a> </a>
            <h2>
              <a> </a>
              <a name="AddConcurrencyField"> </a>
              Add the Concurrency field to the Table
            </h2>
          </li>
          <p>
            First we need to add the 'Concurrency' field to the table we want to
            update. More often than not, this table will be replicated and so we
            will need to use the replication wizard to add the new field to the
            table. To do this:
          </p>
          <ol>
            <li>
              Select a publication and right-click on it and select
              'Properties'.
            </li>
            <li>
              Select the 'Filter Columns' Tab, select the table to modify and
              click the 'Add Column to Table...' button.
              <br />
              <img
                alt="Publication properties"
                border="0"
                height="475"
                src="/archive/standards-internal/developer-sql-server/images/publication-properties.gif"
                width="521"
              />
               
            </li>
            <li>
              Specify the field name as 'Concurrency'. You will need to set a
              default of 0 and the Data Type to integer. You can delete the rest
              of the script. Click OK to add the field.
              <br />
              <img
                alt="Add column"
                border="0"
                height="432"
                src="/archive/standards-internal/developer-sql-server/images/add-column.gif"
                width="444"
              />
            </li>
          </ol>
          <li>
            <h2>
              <a name="UpdateSelectStoredProcedure"> </a>
              Update the Select Stored Procedure
            </h2>
          </li>
          <p>
            Next we need to update the Select Stored Procedure to retrieve the
            'Concurrency' field we created. E.g. the procedure would change to
            (See bold):
          </p>
          <p>
            <i>
              Create Stored Procedure [dbo].[ClientContactSelect]
              <br />
              <br />
              @ContactID int
              <br />
              <br />
              AS
              <br />
              <br />
              SELECT
              <br />
                      ClientContact.FirstName,
              <br />
                      ClientContact.Surname
              <b> , </b>
            </i>
            <b>
              <i>
                <br />
                          ClientContact.Concurrency
              </i>
            </b>
            <i>
              <br />
              FROM
              <br />
                      ClientContact
              <br />
              WHERE
              <br />
                      ClientContact.ContactID = @ContactID
            </i>
          </p>
        </ol>
        <p>
          <i>            GO </i>
        </p>
        <p> </p>
        <br />
      </div>
      <div id="footer">
        <p class="callnow">
          Call Now
          <a href="tel:+61299533000"> +61 2 9953 3000 </a>
        </p>
        <span class="copyright">
          © Copyright SSW 1990-2024. All Rights Reserved.
        </span>
        <ul>
          <li class="first">
            <a
              class="email"
              href="javascript:sendEmail('696E666F407373772E636F6D2E61753F7375626A6563743D466565646261636B20746F2053535726626F64793D687474703A2F2F7373772E636F6D2E61752F7373772F5374616E6461726473496E7465726E616C2F446576656C6F70657253514C5365727665722F484F57544F5365747570436F6E63757272656E6379466F72546865576562536974652E61737078')"
              id="ctl00_fC_feedbackHyperLink"
              tabindex="100"
            >
              Feedback to SSW
            </a>
          </li>
          <li>
            <a href="/ssw/Company/AboutUs.aspx"> About SSW </a>
          </li>
          <li>
            <a href="/ssw/Advertising/Default.aspx"> Advertising </a>
          </li>
          <li class="last">
            <a href="/ssw/MenuMap.aspx"> Sitemap </a>
          </li>
        </ul>
        <span class="proudly">
          <a href="http://www.ssw.com.au">
            Proudly developed by SSW Sydney Web Design
          </a>
        </span>
        <!-- span class="proudlyAjax"><a href="/ssw/Standards/Rules/RulesToBetterWebsitesAdministration.aspx#AJAX">Powered by MS AJAX</a></span -->
        <p class="serverName">
          Our website is under constant continuous deployment. Last deployment
          to AZIIS2022P03. Unable to retrieve changeset details.
        </p>
      </div>
    </form>
    <!--Here's the Google Tracking Code, only available on external servers because we only need to track for external.-->
    <!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com -->
    <!-- / OptinMonster -->
    <div style="visibility: visible">
      <div></div>
      <div></div>
    </div>
  </body>
</html>
